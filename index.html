<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±èªå­¸ç¿’å¹³å° - B1â†’B2é€²éš</title>
    <style>
        :root {
            --primary: #F5C197;
            --primary-hover: #E8B382;
            --success: #F0B8A8;
            --warning: #FDD9BE;
            --danger: #E8A88E;
            --bg: #FFFEF8;
            --surface: #F5E8D9;
            --text: #5C4A42;
            --text-light: #9A8B81;
            --border: #E0CDB9;
            --accent-light: #FFFEF8;
            --accent-warm: #F5E8D9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), #E8B382);
            color: #5C4A42;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .header-left {
            flex: 1;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .user-controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .current-user {
            background: rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 14px;
        }

        .user-btn {
            background: rgba(255,255,255,0.4);
            color: #5C4A42;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: background 0.3s ease;
        }

        .user-btn:hover {
            background: rgba(255,255,255,0.6);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--surface);
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .modal-content h3 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .user-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .user-item {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            cursor: pointer;
            border-left: 4px solid var(--primary);
            transition: background 0.3s ease;
        }

        .user-item:hover {
            background: #f5f5f5;
        }

        .user-item.active {
            background: #fffaeb;
            font-weight: 500;
        }

        .user-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .modal-close {
            background: var(--border);
            color: var(--text);
        }

        .modal-close:hover {
            background: #d0d0d0;
        }

        .modal-confirm {
            background: var(--primary);
            color: white;
        }

        .modal-confirm:hover {
            background: var(--primary-hover);
        }

        .stat-card {
            background: linear-gradient(135deg, #F5C197 0%, #E8B382 100%);
            color: #5C4A42;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }

        .grammar-question {
            background: white;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary);
        }

        .grammar-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }

        .option {
            background: #FFFEF8;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: var(--primary);
            background: #fffaeb;
        }

        .option input[type="radio"] {
            margin-right: 8px;
        }

        .option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .grammar-explanation {
            background: #FFF5E6;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid var(--warning);
            font-size: 13px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }

        .section {
            background: var(--surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.8);
            border: 1px solid var(--border);
        }

        .section h2 {
            font-size: 20px;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .tab {
            padding: 12px 16px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-light);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .schedule-day {
            background: #FFFEF8;
            border-left: 5px solid var(--primary);
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-top: 1px solid var(--border);
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .schedule-day h4 {
            color: var(--primary);
            margin-bottom: 6px;
        }

        .schedule-day p {
            font-size: 14px;
            color: var(--text-light);
            margin: 4px 0;
        }

        .study-blocks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .block {
            background: linear-gradient(135deg, #F5C197 0%, #E8B382 100%);
            color: #5C4A42;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .block.input {
            background: linear-gradient(135deg, #F5C197 0%, #E8B382 100%);
        }

        .block.output {
            background: linear-gradient(135deg, #EDB89F 0%, #E3A88B 100%);
        }

        .block.integration {
            background: linear-gradient(135deg, #FDD9BE 0%, #F5C9B0 100%);
        }

        .block h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .block-time {
            font-size: 28px;
            font-weight: bold;
            margin: 12px 0;
        }

        .block-desc {
            font-size: 13px;
            opacity: 0.95;
        }

        .writing-exercise {
            background: #FFFEF8;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            border: 1px solid var(--border);
        }

        .writing-exercise h4 {
            color: var(--primary);
            margin-bottom: 8px;
        }

        .writing-exercise .example {
            background: white;
            padding: 10px;
            border-left: 3px solid var(--warning);
            margin: 8px 0;
            font-size: 13px;
            border-radius: 4px;
        }

        .writing-exercise .tips {
            background: #FFFEF8;
            padding: 10px;
            border-radius: 4px;
            font-size: 13px;
            color: #9A8B81;
            margin-top: 8px;
            border-left: 3px solid var(--primary);
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 10px;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(245, 193, 151, 0.2);
        }

        .btn {
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-hover);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #388E3C;
        }

        .feedback {
            margin-top: 12px;
            padding: 12px;
            border-radius: 6px;
            font-size: 13px;
        }

        .feedback.error {
            background: #FFE8DC;
            color: #E8A88E;
            border-left: 4px solid #E8A88E;
        }

        .feedback.success {
            background: #FFFAEB;
            color: #F0B8A8;
            border-left: 4px solid #F0B8A8;
        }

        .feedback.info {
            background: #FFF5E6;
            color: #9A8B81;
            border-left: 4px solid #9A8B81;
        }

        .progress-section {
            margin-top: 20px;
        }

        .progress-item {
            margin-bottom: 12px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .vocabulary-card {
            background: #FFFEF8;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 5px solid var(--primary);
            border-top: 1px solid var(--border);
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .vocabulary-card .word {
            font-weight: bold;
            color: var(--primary);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .play-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease, transform 0.2s ease;
            flex-shrink: 0;
        }

        .play-btn:hover {
            background: var(--primary-hover);
            transform: scale(1.1);
        }

        .play-btn:active {
            transform: scale(0.95);
        }

        .play-btn.playing {
            background: var(--success);
            animation: pulse 0.6s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .vocabulary-card .pronunciation {
            font-style: italic;
            color: var(--text-light);
            font-size: 13px;
        }

        .vocabulary-card .meaning {
            margin-top: 6px;
            color: var(--text);
        }

        .vocabulary-card .example {
            margin-top: 6px;
            color: var(--text-light);
            font-size: 13px;
            border-left: 2px solid var(--warning);
            padding-left: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }

            .study-blocks {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>ğŸ¯ è‹±èªå­¸ç¿’å¹³å°</h1>
            <p>B1â†’B2 é€²éšèª²ç¨‹ | æ¯æ—¥15åˆ†é˜é›†ä¸­å­¸ç¿’</p>
            <p id="dateDisplay" style="font-size: 12px; opacity: 0.8; margin-top: 5px;">ğŸ“… ä»Šå¤©çš„æ—¥æœŸ</p>
        </div>
        <div class="user-controls">
            <div class="current-user" id="currentUserDisplay">ğŸ‘¤ éŠå®¢</div>
            <button class="user-btn" onclick="openUserModal()">ğŸ‘¥ åˆ‡æ›ç”¨æˆ¶</button>
            <button class="user-btn" onclick="previewFutureDay()">ğŸ“‹ æŸ¥çœ‹é è¦½</button>
        </div>
    </div>

    <!-- ç”¨æˆ¶ç®¡ç†æ¨¡æ…‹æ¡† -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <h3>ğŸ‘¥ ç”¨æˆ¶ç®¡ç†</h3>
            <div class="user-list" id="userList"></div>
            <input type="text" id="newUserInput" class="user-input" placeholder="è¼¸å…¥æ–°ç”¨æˆ¶å...">
            <div class="modal-buttons">
                <button class="modal-close" onclick="closeUserModal()">å–æ¶ˆ</button>
                <button class="modal-confirm" onclick="createNewUser()">æ–°å»ºç”¨æˆ¶</button>
            </div>
        </div>
    </div>

    <!-- æ—¥æœŸé è¦½æ¨¡æ…‹æ¡† -->
    <div id="previewModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3>ğŸ“… æœªä¾†æ—¥æœŸå…§å®¹é è¦½</h3>
            <div style="margin-bottom: 20px;">
                <div style="margin-bottom: 15px;">
                    <label style="font-weight: 500; color: var(--primary); display: block; margin-bottom: 8px;">é¸æ“‡æ—¥æœŸï¼š</label>
                    <input type="date" id="previewDate" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 6px; font-size: 14px;">
                </div>
                <button class="btn" onclick="loadPreviewContent()" style="width: 100%; margin-bottom: 15px;">é è¦½è©²æ—¥æœŸå…§å®¹</button>
            </div>
            <div id="previewContent" style="background: white; padding: 15px; border-radius: 6px; max-height: 400px; overflow-y: auto;"></div>
            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="modal-close" onclick="closePreviewModal()" style="flex: 1;">é—œé–‰</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- çµ±è¨ˆé¢æ¿ -->
        <div class="section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="dayCount">0</div>
                    <div class="stat-label">å­¸ç¿’å¤©æ•¸</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #EDB89F 0%, #E3A88B 100%);">
                    <div class="stat-number" id="wordCount">0</div>
                    <div class="stat-label">æ–°å–®å­—</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #FDD9BE 0%, #F5C9B0 100%);">
                    <div class="stat-number" id="writingCount">0</div>
                    <div class="stat-label">å¯«ä½œç¯‡æ•¸</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #F0B8A8 0%, #E8A88E 100%);">
                    <div class="stat-number" id="streak">0</div>
                    <div class="stat-label">é€£çºŒå¤©æ•¸</div>
                </div>
            </div>
        </div>

        <!-- 5-5-5 å­¸ç¿’æ–¹æ³• -->
        <div class="section">
            <h2>â±ï¸ æ¯æ—¥5-5-5å­¸ç¿’æ–¹æ³•</h2>
            <div class="study-blocks">
                <div class="block input">
                    <h3>ğŸ“» Block 1: è½åŠ›è¼¸å…¥</h3>
                    <div class="block-time">5 åˆ†é˜</div>
                    <div class="block-desc">
                        æ’­æ”¾è‹±æ–‡å°è©±ã€TEDæ¼”è¬›æˆ–æ–°èç‰‡æ®µ
                        <br><small>æå‡è½åŠ›ç†è§£èƒ½åŠ›</small>
                    </div>
                </div>
                <div class="block output">
                    <h3>ğŸ¤ Block 2: å£èªªè¼¸å‡º</h3>
                    <div class="block-time">5 åˆ†é˜</div>
                    <div class="block-desc">
                        è·Ÿè®€ã€è‡ªç”±æ¼”è¬›æˆ–å°è©±ç·´ç¿’
                        <br><small>åŸ¹é¤Šå£èªªæµæš¢åº¦</small>
                    </div>
                </div>
                <div class="block integration">
                    <h3>âœï¸ Block 3: å¯«ä½œæ•´åˆ</h3>
                    <div class="block-time">5 åˆ†é˜</div>
                    <div class="block-desc">
                        å¾®å¯«ä½œç·´ç¿’ã€å¥å­çµ„ç¹”
                        <br><small>å¼·åŒ–å¯«ä½œè¡¨é”èƒ½åŠ›</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ¯é€±å­¸ç¿’è¨ˆåŠƒ -->
        <div class="section">
            <h2>ğŸ“… æ¯é€±å­¸ç¿’ä¸»é¡Œè¨ˆåŠƒ</h2>
            <div id="scheduleContent"></div>
        </div>

        <!-- æ–‡æ³•å­¸ç¿’æ ¸å¿ƒ -->
        <div class="section">
            <h2>ğŸ“– B2 é€²éšæ–‡æ³•å­¸ç¿’</h2>
            <div class="tabs" id="grammarTabs">
                <button class="tab active" onclick="switchGrammarTab(0)">ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼</button>
                <button class="tab" onclick="switchGrammarTab(1)">ä»‹ç³»è©æ‡‰ç”¨</button>
                <button class="tab" onclick="switchGrammarTab(2)">è©æ€§è¾¨æ</button>
                <button class="tab" onclick="switchGrammarTab(3)">ä¸»è©å‹•è©ä¸€è‡´</button>
                <button class="tab" onclick="switchGrammarTab(4)">è™›æ“¬èªæ°£é€²éš</button>
            </div>

            <div id="grammarContent">
                <!-- ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼ -->
                <div class="tab-content active" id="grammarTab0">
                    <div class="writing-exercise">
                        <h4>ğŸ“– ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼</h4>
                        <div class="grammar-explanation">
                            <strong>ç¾åœ¨å®Œæˆå¼ (Present Perfect):</strong> ç”¨æ–¼æè¿°å¾éå»åˆ°ç¾åœ¨ä»æœ‰å½±éŸ¿çš„è¡Œç‚ºã€‚<br>
                            <strong>éå»å®Œæˆå¼ (Past Perfect):</strong> ç”¨æ–¼æè¿°æ¯”å¦ä¸€å€‹éå»äº‹ä»¶æ›´æ—©ç™¼ç”Ÿçš„è¡Œç‚ºã€‚<br><br>
                            ä¾‹å¥ï¼š<br>
                            â€¢ I <strong>have lived</strong> here for 5 years. (æˆ‘ä½åœ¨é€™è£¡5å¹´äº†ï¼Œç¾åœ¨ä»ä½åœ¨é€™è£¡)<br>
                            â€¢ I <strong>had lived</strong> here for 5 years when I moved. (æˆ‘æ¬å®¶å‰ä½äº†5å¹´)
                        </div>
                        <div id="grammarQuiz0"></div>
                    </div>
                </div>

                <!-- ä»‹ç³»è©æ‡‰ç”¨ -->
                <div class="tab-content" id="grammarTab1">
                    <div class="writing-exercise">
                        <h4>ğŸ“– ä»‹ç³»è©æ‡‰ç”¨</h4>
                        <div class="grammar-explanation">
                            <strong>ä»‹ç³»è©ç”¨é€”ï¼š</strong><br>
                            â€¢ <strong>for:</strong> è¡¨ç¤ºç›®çš„ã€æŒçºŒæ™‚é–“ (responsible for, look forward to)<br>
                            â€¢ <strong>on:</strong> è¡¨ç¤ºå…·é«”æ—¥æœŸã€é—œæ–¼ (on June 15th, focus on)<br>
                            â€¢ <strong>in:</strong> è¡¨ç¤ºèˆˆè¶£ã€æ™‚é–“æ®µ (interested in, in June)<br><br>
                            ä¾‹å¥ï¼š<br>
                            â€¢ The manager is responsible <strong>for</strong> the entire project.<br>
                            â€¢ We are looking forward <strong>to</strong> your arrival next week.
                        </div>
                        <div id="grammarQuiz1"></div>
                    </div>
                </div>

                <!-- è©æ€§è¾¨æ -->
                <div class="tab-content" id="grammarTab2">
                    <div class="writing-exercise">
                        <h4>ğŸ“– è©æ€§è¾¨æ</h4>
                        <div class="grammar-explanation">
                            <strong>å¸¸è¦‹è©æ€§è½‰æ›ï¼š</strong><br>
                            â€¢ grow (å‹•è©) â†’ growth (åè©) â†’ growing (å½¢å®¹è©/ç¾åœ¨åˆ†è©)<br>
                            â€¢ success (åè©) â†’ successful (å½¢å®¹è©) â†’ successfully (å‰¯è©)<br>
                            â€¢ commit (å‹•è©) â†’ commitment (åè©) â†’ committed (å½¢å®¹è©)<br><br>
                            ä¾‹å¥ï¼š<br>
                            â€¢ The <strong>growth</strong> of the company has increased. (åè©ä½œä¸»èª)<br>
                            â€¢ The project was <strong>successfully</strong> completed. (å‰¯è©ä¿®é£¾å‹•è©)
                        </div>
                        <div id="grammarQuiz2"></div>
                    </div>
                </div>

                <!-- ä¸»è©å‹•è©ä¸€è‡´ -->
                <div class="tab-content" id="grammarTab3">
                    <div class="writing-exercise">
                        <h4>ğŸ“– ä¸»è©å‹•è©ä¸€è‡´</h4>
                        <div class="grammar-explanation">
                            <strong>ä¸€è‡´è¦å‰‡ï¼š</strong><br>
                            â€¢ é›†é«”åè© (team, group) ç”¨å–®æ•¸å‹•è©<br>
                            â€¢ <strong>neither...nor</strong> èˆ‡æœ€è¿‘çš„åè©ä¸€è‡´<br>
                            â€¢ <strong>the number of</strong> + è¤‡æ•¸åè©ç”¨å–®æ•¸å‹•è©<br>
                            â€¢ <strong>each of</strong> + è¤‡æ•¸åè©ç”¨å–®æ•¸å‹•è©<br><br>
                            ä¾‹å¥ï¼š<br>
                            â€¢ The team <strong>is</strong> working on the new strategy.<br>
                            â€¢ The number of applicants <strong>has</strong> exceeded expectations.
                        </div>
                        <div id="grammarQuiz3"></div>
                    </div>
                </div>

                <!-- è™›æ“¬èªæ°£é€²éš -->
                <div class="tab-content" id="grammarTab4">
                    <div class="writing-exercise">
                        <h4>ğŸ“– è™›æ“¬èªæ°£é€²éš</h4>
                        <div class="grammar-explanation">
                            <strong>è™›æ“¬èªæ°£åˆ†é¡ï¼š</strong><br>
                            â€¢ <strong>ç¬¬ä¸€é¡ï¼š</strong> If + Present, will + V (çœŸå¯¦æ¢ä»¶)<br>
                            â€¢ <strong>ç¬¬äºŒé¡ï¼š</strong> If + Past, would + V (å‡è¨­ç¾åœ¨)<br>
                            â€¢ <strong>ç¬¬ä¸‰é¡ï¼š</strong> If + Past Perfect, would have + V (å‡è¨­éå»)<br><br>
                            ä¾‹å¥ï¼š<br>
                            â€¢ If you study hard, you <strong>will</strong> pass.<br>
                            â€¢ If you studied hard, you <strong>would</strong> pass.<br>
                            â€¢ If you had studied hard, you <strong>would have</strong> passed.
                        </div>
                        <div id="grammarQuiz4"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¯«ä½œç·´ç¿’æ ¸å¿ƒ -->
        <div class="section">
            <h2>âœï¸ å¯«ä½œç·´ç¿’å·¥ä½œå€</h2>
            <div class="tabs" id="writingTabs">
                <button class="tab active" onclick="switchWritingTab(0)">ç´šåˆ¥1ï¼šå¥å­çµ„åˆ</button>
                <button class="tab" onclick="switchWritingTab(1)">ç´šåˆ¥2ï¼šæ®µè½å¯«ä½œ</button>
                <button class="tab" onclick="switchWritingTab(2)">ç´šåˆ¥3ï¼šçŸ­æ–‡å‰µä½œ</button>
            </div>

            <div id="writingContent">
                <!-- ç´šåˆ¥1 -->
                <div class="tab-content active" id="writingTab0">
                    <div class="writing-exercise">
                        <h4>ğŸ“ å¥å­çµ„åˆç·´ç¿’</h4>
                        <p style="color: var(--text-light); font-size: 14px; margin-bottom: 10px;">å°‡å…©å€‹ç°¡å–®å¥å­ç”¨é€£æ¥è©çµ„åˆæˆè¤‡é›œå¥</p>

                        <div id="exercise1" style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <p><strong>é¡Œç›®ï¼š</strong> <span id="ex1Question"></span></p>
                            <p style="margin-top: 10px;"><strong>æç¤ºï¼š</strong> <span id="ex1Hint" style="color: var(--primary);"></span></p>
                        </div>

                        <textarea id="answer1" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„ç­”æ¡ˆ..."></textarea>

                        <button class="btn" onclick="checkLevel1()">æäº¤æª¢æŸ¥</button>
                        <div id="feedback1"></div>

                        <div class="tips">
                            ğŸ’¡ æç¤ºï¼šä½¿ç”¨ because, although, when, if, unless ç­‰é€£æ¥è©
                        </div>
                    </div>
                </div>

                <!-- ç´šåˆ¥2 -->
                <div class="tab-content" id="writingTab1">
                    <div class="writing-exercise">
                        <h4>ğŸ“ æ®µè½å¯«ä½œç·´ç¿’</h4>
                        <p style="color: var(--text-light); font-size: 14px; margin-bottom: 10px;">æ ¹æ“šé—œéµè©å¯«å‡ºä¸€å€‹3-5å¥çš„æ®µè½</p>

                        <div id="exercise2" style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <p><strong>ä¸»é¡Œï¼š</strong> <span id="ex2Topic"></span></p>
                            <p style="margin-top: 10px;"><strong>é—œéµè©ï¼š</strong> <span id="ex2Keywords" style="color: var(--primary);"></span></p>
                        </div>

                        <textarea id="answer2" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„ç­”æ¡ˆ..."></textarea>

                        <button class="btn" onclick="checkLevel2()">æäº¤æª¢æŸ¥</button>
                        <div id="feedback2"></div>

                        <div class="tips">
                            ğŸ’¡ æç¤ºï¼šæ¯å€‹æ®µè½æ‡‰è©²æœ‰ä¸»é¡Œå¥å’Œæ”¯æŒå¥ã€‚ç¢ºä¿ä½¿ç”¨å¤šæ¨£çš„å¥å­çµæ§‹ã€‚
                        </div>
                    </div>
                </div>

                <!-- ç´šåˆ¥3 -->
                <div class="tab-content" id="writingTab2">
                    <div class="writing-exercise">
                        <h4>ğŸ“ çŸ­æ–‡å‰µä½œç·´ç¿’</h4>
                        <p style="color: var(--text-light); font-size: 14px; margin-bottom: 10px;">æ ¹æ“šä¸»é¡Œå¯«å‡ºä¸€ç¯‡150-200å­—çš„çŸ­æ–‡</p>

                        <div id="exercise3" style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <p><strong>å¯«ä½œä¸»é¡Œï¼š</strong> <span id="ex3Topic"></span></p>
                        </div>

                        <textarea id="answer3" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„ç­”æ¡ˆ..."></textarea>
                        <div style="font-size: 13px; color: var(--text-light); margin-bottom: 10px;">å­—æ•¸ï¼š<span id="wordCounter">0</span>/150-200</div>

                        <button class="btn" onclick="checkLevel3()">æäº¤æª¢æŸ¥</button>
                        <div id="feedback3"></div>

                        <div class="tips">
                            ğŸ’¡ æç¤ºï¼šåŒ…å«å¼•å…¥ã€ä¸»é«”å’Œçµè«–ã€‚ä½¿ç”¨éæ¸¡è©(however, furthermore, in conclusion)å¢åŠ æ–‡ç« é€£è²«æ€§ã€‚
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- è©å½™å­¸ç¿’ -->
        <div class="section">
            <h2>ğŸ“š B2 é€²éšè©å½™å­¸ç¿’ (60å¤©ç„¡é‡è¤‡)</h2>
            <div id="vocabularyList"></div>
        </div>

        <!-- é€²åº¦è¿½è¹¤ -->
        <div class="section">
            <h2>ğŸ“Š å­¸ç¿’é€²åº¦</h2>
            <div class="progress-section">
                <div class="progress-item">
                    <div class="progress-label">
                        <span>è½åŠ›ç†è§£ (Listening)</span>
                        <span id="listeningPct">65%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 65%; background: #2196F3;"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>å£èªªæµæš¢ (Speaking)</span>
                        <span id="speakingPct">60%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 60%; background: #4CAF50;"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>é–±è®€ç†è§£ (Reading)</span>
                        <span id="readingPct">70%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 70%; background: #FF9800;"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>å¯«ä½œèƒ½åŠ› (Writing)</span>
                        <span id="writingPct">55%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 55%; background: #F44336;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== è³‡æ–™åº«ï¼šæ¯é€±å®‰æ’ =====
        const scheduleData = [
            { day: 'ğŸŒ™ æ˜ŸæœŸä¸€', theme: 'å•†å‹™è‹±æ–‡', focus: 'Emailå¯«ä½œã€æœƒè­°ç”¨èª', keywords: 'proposal, agenda, deadline' },
            { day: 'ğŸŒ™ æ˜ŸæœŸäºŒ', theme: 'æ—¥å¸¸ç”Ÿæ´»', focus: 'æ—¥å¸¸å°è©±ã€è³¼ç‰©ã€é¤å»³', keywords: 'I\'d like, could you, absolutely' },
            { day: 'ğŸ“– æ˜ŸæœŸä¸‰', theme: 'é–±è®€æ—¥', focus: 'æ–°èæ–‡ç« ã€éƒ¨è½æ ¼', keywords: 'è¤‡é›œå¥å­ã€é•·ç¯‡æ–‡ç« ' },
            { day: 'âœï¸ æ˜ŸæœŸå››', theme: 'å¯«ä½œæ—¥', focus: 'çŸ­æ–‡ã€æ®µè½ã€è«–æ–‡', keywords: 'æ®µè½çµæ§‹ã€éŠœæ¥è©' },
            { day: 'ğŸ¤ æ˜ŸæœŸäº”', theme: 'å£èªªç·´ç¿’', focus: 'æ¼”è¬›ã€è¨è«–ã€è¾¯è«–', keywords: 'argue, emphasize, persuade' },
            { day: 'ğŸ¯ æ˜ŸæœŸå…­', theme: 'ç¶œåˆè¤‡ç¿’', focus: 'æ··åˆæŠ€èƒ½ç·´ç¿’', keywords: 'è¤‡ç¿’æ‰€æœ‰æŠ€èƒ½' },
            { day: 'ğŸ“Š æ˜ŸæœŸæ—¥', theme: 'è©•ä¼°æ¸¬è©¦', focus: 'é€±æ¸¬é©—ã€é€²åº¦è©•ä¼°', keywords: 'é€²åº¦æª¢æ¸¬' }
        ];

        // ===== è³‡æ–™åº«ï¼šå¯«ä½œé¡Œåº« (60å¤©) =====
        const writingExercisesBank = {
            level1: [
                { question: 'Combine: "She finished her homework. She went to play." Answer should use a conjunction.', hint: 'Use "after" or "before"' },
                { question: 'Combine: "He studied hard. He passed the exam." Answer should use a conjunction.', hint: 'Use "so" or "because"' },
                { question: 'Combine: "The weather was bad. We went outside anyway." Answer should use a conjunction.', hint: 'Use "although" or "even though"' },
                { question: 'Combine: "I finished my work. I went home." Answer should use a conjunction.', hint: 'Use "after" or "when"' },
                { question: 'Combine: "She was tired. She continued studying." Answer should use a conjunction.', hint: 'Use "though" or "despite"' },
                { question: 'Combine: "He won the competition. He practiced every day." Answer should use a conjunction.', hint: 'Use "because" or "since"' },
                { question: 'Combine: "The meeting ended. Everyone went to lunch." Answer should use a conjunction.', hint: 'Use "after" or "once"' },
                { question: 'Combine: "She was sick. She still attended the class." Answer should use a conjunction.', hint: 'Use "although" or "despite"' },
                { question: 'Combine: "He arrives early. He always gets a good seat." Answer should use a conjunction.', hint: 'Use "because" or "so"' },
                { question: 'Combine: "The project is difficult. The team is determined." Answer should use a conjunction.', hint: 'Use "although" or "but"' },
                { question: 'Combine: "You study regularly. You will improve." Answer should use a conjunction.', hint: 'Use "if" or "as long as"' },
                { question: 'Combine: "The presentation was clear. Everyone understood." Answer should use a conjunction.', hint: 'Use "so" or "therefore"' },
                { question: 'Combine: "It was raining. They played football." Answer should use a conjunction.', hint: 'Use "although" or "despite"' },
                { question: 'Combine: "She spoke softly. Everyone listened carefully." Answer should use a conjunction.', hint: 'Use "because" or "so"' },
                { question: 'Combine: "The restaurant is expensive. The food is excellent." Answer should use a conjunction.', hint: 'Use "although" or "but"' },
                { question: 'Combine: "He forgot his key. He had to wait outside." Answer should use a conjunction.', hint: 'Use "because" or "since"' },
                { question: 'Combine: "She finished first. She was the fastest runner." Answer should use a conjunction.', hint: 'Use "because" or "as"' },
                { question: 'Combine: "The movie was long. I enjoyed it." Answer should use a conjunction.', hint: 'Use "although" or "but"' },
                { question: 'Combine: "He left early. He had an appointment." Answer should use a conjunction.', hint: 'Use "because" or "since"' },
                { question: 'Combine: "The weather improved. We went for a walk." Answer should use a conjunction.', hint: 'Use "so" or "therefore"' }
            ],
            level2: [
                { topic: 'My favorite hobby', keywords: 'enjoy, practice, improve, passion' },
                { topic: 'A memorable travel experience', keywords: 'memorable, experience, learned, cultural' },
                { topic: 'The role of technology in education', keywords: 'technology, learning, improve, access' },
                { topic: 'How to manage time effectively', keywords: 'schedule, priority, focus, achieve' },
                { topic: 'The importance of friendship', keywords: 'support, trust, loyal, meaningful' },
                { topic: 'Environmental protection initiatives', keywords: 'protect, recycle, sustainable, future' },
                { topic: 'Healthy lifestyle choices', keywords: 'exercise, nutrition, balance, wellness' },
                { topic: 'Digital communication benefits', keywords: 'connect, convenient, instant, global' },
                { topic: 'Cultural diversity in my community', keywords: 'diverse, tradition, celebrate, respect' },
                { topic: 'Career development strategies', keywords: 'skills, growth, motivation, success' },
                { topic: 'The power of reading', keywords: 'imagination, knowledge, escape, expand' },
                { topic: 'Challenges of modern parenting', keywords: 'responsibility, guidance, patience, nurture' },
                { topic: 'Benefits of lifelong learning', keywords: 'curiosity, adaptation, knowledge, growth' },
                { topic: 'Social media impact on society', keywords: 'connection, influence, awareness, concern' },
                { topic: 'Importance of mental health', keywords: 'awareness, support, stress, wellbeing' },
                { topic: 'Economic development in developing nations', keywords: 'growth, opportunity, investment, progress' },
                { topic: 'The art of effective communication', keywords: 'clarity, empathy, understanding, connection' },
                { topic: 'Sustainable fashion and clothing', keywords: 'ethical, environment, quality, consciousness' },
                { topic: 'The role of sports in society', keywords: 'teamwork, discipline, achievement, health' },
                { topic: 'Urban vs rural living experiences', keywords: 'lifestyle, convenience, community, nature' }
            ],
            level3: [
                { topic: 'The importance of learning English in the digital age' },
                { topic: 'How to balance work and personal life' },
                { topic: 'The impact of social media on society' },
                { topic: 'Why continuous learning is essential for success' },
                { topic: 'Environmental protection and individual responsibility' },
                { topic: 'The role of artificial intelligence in education' },
                { topic: 'How globalization has changed our world' },
                { topic: 'The importance of cultural exchange and understanding' },
                { topic: 'Technology and its effects on human relationships' },
                { topic: 'Education equality and access in developing countries' },
                { topic: 'The future of remote work and its implications' },
                { topic: 'Climate change and personal lifestyle choices' },
                { topic: 'Mental health awareness in educational institutions' },
                { topic: 'The role of government in public health' },
                { topic: 'Economic inequality and social justice' },
                { topic: 'Ethical considerations in genetic engineering' },
                { topic: 'The influence of traditional media vs social media' },
                { topic: 'Sustainable tourism and cultural preservation' },
                { topic: 'Digital literacy in modern education systems' },
                { topic: 'Immigration and its effects on host countries' }
            ]
        };

        // ===== è³‡æ–™åº«ï¼šæ–‡æ³•é¡Œåº«ï¼ˆå¾è‹±æ–‡è³‡æ–™åº«åˆä½µï¼‰ =====
        const grammarData = [
            {
                topic: 'ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼',
                questions: [
                    { question: 'I _____ in this city for 10 years.', options: ['lived', 'have lived', 'had lived', 'was living'], correct: 1, explanation: 'ç¾åœ¨å®Œæˆå¼è¡¨ç¤ºå¾éå»åˆ°ç¾åœ¨çš„æŒçºŒç‹€æ…‹ã€‚' },
                    { question: 'Before he arrived, they _____ the meeting.', options: ['started', 'have started', 'had started', 'were starting'], correct: 2, explanation: 'éå»å®Œæˆå¼è¡¨ç¤ºåœ¨å¦ä¸€å€‹éå»å‹•ä½œä¹‹å‰ç™¼ç”Ÿçš„äº‹ã€‚' },
                    { question: 'She _____ three novels since she started writing.', options: ['writes', 'has written', 'had written', 'wrote'], correct: 1, explanation: 'ç¾åœ¨å®Œæˆå¼è¡¨ç¤ºå·²å®Œæˆçš„å‹•ä½œã€‚' },
                    { question: 'By the time we arrived, the movie _____ started.', options: ['has', 'have', 'had', 'was'], correct: 2, explanation: 'éå»å®Œæˆå¼è¡¨ç¤ºå…©å€‹éå»å‹•ä½œçš„æ™‚é–“é †åºã€‚' },
                    { question: 'I _____ that book three times already.', options: ['read', 'have read', 'had read', 'am reading'], correct: 1, explanation: 'å·²ç¶“...è¡¨ç¤ºä½¿ç”¨ç¾åœ¨å®Œæˆå¼ã€‚' },
                    { question: 'They _____ the project before the deadline.', options: ['complete', 'have completed', 'had completed', 'completed'], correct: 2, explanation: 'éå»å®Œæˆå¼è¡¨ç¤ºæ›´æ—©çš„éå»äº‹ä»¶ã€‚' }
                ]
            },
            {
                topic: 'ä»‹ç³»è©æ‡‰ç”¨',
                questions: [
                    { question: 'The manager is responsible _____ the entire project.', options: ['in', 'for', 'at', 'on'], correct: 1, explanation: 'responsible forè¡¨ç¤ºè² è²¬ã€‚' },
                    { question: 'We are looking _____ to your arrival next week.', options: ['at', 'forward', 'for', 'after'], correct: 1, explanation: 'look forward toè¡¨ç¤ºæœŸå¾…ã€‚' },
                    { question: 'The training will be held _____ June 15th at 2 PM.', options: ['at', 'on', 'in', 'by'], correct: 1, explanation: 'å…·é«”æ—¥æœŸå‰ç”¨onã€‚' },
                    { question: '_____ the budget constraints, the company still invested.', options: ['Although', 'Despite', 'Because', 'Due to'], correct: 1, explanation: 'Despiteå¾Œæ¥åè©ç‰‡èªã€‚' },
                    { question: 'We succeeded _____ great effort and determination.', options: ['by', 'with', 'through', 'in'], correct: 2, explanation: 'throughè¡¨ç¤ºè—‰ç”±ã€‚' },
                    { question: 'She is interested _____ learning new languages.', options: ['in', 'on', 'at', 'for'], correct: 0, explanation: 'interested inè¡¨ç¤ºå°...æœ‰èˆˆè¶£ã€‚' },
                    { question: 'The report focuses _____ market trends.', options: ['in', 'on', 'at', 'for'], correct: 1, explanation: 'focus onè¡¨ç¤ºé—œæ³¨ã€‚' },
                    { question: 'I have never heard _____ this company before.', options: ['of', 'about', 'from', 'in'], correct: 0, explanation: 'hear ofè¡¨ç¤ºè½èªªã€‚' },
                    { question: 'The employees are committed _____ the company\'s mission.', options: ['to', 'for', 'on', 'in'], correct: 0, explanation: 'committed toè¡¨ç¤ºè‡´åŠ›æ–¼ã€‚' },
                    { question: 'This decision is based _____ market research.', options: ['on', 'in', 'at', 'for'], correct: 0, explanation: 'based onè¡¨ç¤ºåŸºæ–¼ã€‚' }
                ]
            },
            {
                topic: 'è©æ€§è¾¨æ',
                questions: [
                    { question: 'The _____ of the company has increased significantly.', options: ['growth', 'grow', 'growing', 'grows'], correct: 0, explanation: 'å† è©Theå¾Œéœ€è¦åè©ã€‚' },
                    { question: 'The project was _____ completed before the deadline.', options: ['success', 'successfully', 'succeed', 'successful'], correct: 1, explanation: 'ä¿®é£¾å‹•è©éœ€è¦å‰¯è©ã€‚' },
                    { question: 'We received an _____ proposal from our partner.', options: ['impress', 'impressive', 'impressed', 'impression'], correct: 1, explanation: 'ä¿®é£¾åè©éœ€è¦å½¢å®¹è©ã€‚' },
                    { question: 'The employee\'s _____ to the job is commendable.', options: ['commit', 'commitment', 'committed', 'commits'], correct: 1, explanation: '\'så¾Œéœ€è¦åè©ã€‚' },
                    { question: 'All participants must _____ to the code of conduct.', options: ['comply', 'compliance', 'compliant', 'complied'], correct: 0, explanation: 'åŠ©å‹•è©mustå¾Œç”¨å‹•è©åŸå½¢ã€‚' },
                    { question: 'The _____ team completed the task on time.', options: ['efficiency', 'efficient', 'efficiently', 'effect'], correct: 1, explanation: 'ä¿®é£¾åè©teaméœ€è¦å½¢å®¹è©ã€‚' },
                    { question: 'Her _____ in solving problems was impressive.', options: ['able', 'ability', 'ably', 'enable'], correct: 1, explanation: 'ä¸»èªå¾Œéœ€è¦åè©ã€‚' },
                    { question: 'The system will _____ improve our workflow.', options: ['significant', 'significantly', 'significance', 'signify'], correct: 1, explanation: 'ä¿®é£¾å‹•è©improveéœ€è¦å‰¯è©ã€‚' },
                    { question: 'We need to make a _____ decision quickly.', options: ['decide', 'decision', 'decisive', 'decidedly'], correct: 2, explanation: 'ä¿®é£¾åè©decisionéœ€è¦å½¢å®¹è©ã€‚' },
                    { question: 'The _____ was clear and well-organized.', options: ['present', 'presence', 'presentation', 'presentable'], correct: 2, explanation: 'ä¸»èªéœ€è¦åè©ã€‚' }
                ]
            },
            {
                topic: 'ä¸»è©å‹•è©ä¸€è‡´',
                questions: [
                    { question: 'The team _____ working on the new strategy.', options: ['are', 'is', 'have', 'has been'], correct: 1, explanation: 'é›†é«”åè©teamç”¨å–®æ•¸ã€‚' },
                    { question: 'Neither the manager nor the employees _____ available.', options: ['is', 'are', 'was', 'be'], correct: 1, explanation: 'neither...norèˆ‡æœ€è¿‘ä¸»è©employeesä¸€è‡´ã€‚' },
                    { question: 'The number of applicants _____ exceeded expectations.', options: ['have', 'has', 'was', 'were'], correct: 1, explanation: 'the number ofç”¨å–®æ•¸ã€‚' },
                    { question: 'Each of the participants _____ received a certificate.', options: ['have', 'has', 'were', 'are'], correct: 1, explanation: 'each ofç”¨å–®æ•¸ã€‚' },
                    { question: 'The group _____ divided into three teams.', options: ['are', 'is', 'have', 'has'], correct: 1, explanation: 'é›†é«”åè©groupç”¨å–®æ•¸ã€‚' },
                    { question: 'A number of employees _____ joined the program.', options: ['has', 'have', 'is', 'was'], correct: 1, explanation: 'a number ofç”¨è¤‡æ•¸ã€‚' },
                    { question: 'The majority of the budget _____ allocated.', options: ['are', 'is', 'have', 'has'], correct: 1, explanation: 'majorityå–®ç¨ç”¨å–®æ•¸ã€‚' },
                    { question: 'Both of them _____ excellent skills.', options: ['has', 'have', 'is', 'was'], correct: 1, explanation: 'bothç”¨è¤‡æ•¸ã€‚' },
                    { question: 'Everyone in the office _____ received the memo.', options: ['have', 'has', 'are', 'were'], correct: 1, explanation: 'everyoneç”¨å–®æ•¸ã€‚' },
                    { question: 'The statistics _____ show a positive trend.', options: ['is', 'are', 'was', 'has'], correct: 1, explanation: 'statisticsä½œè¤‡æ•¸ç”¨ã€‚' }
                ]
            },
            {
                topic: 'åˆ†è©èˆ‡å½¢å®¹è©',
                questions: [
                    { question: 'The _____ results met all requirements.', options: ['expected', 'expecting', 'expect', 'expects'], correct: 0, explanation: 'éå»åˆ†è©ä¿®é£¾åè©ã€‚' },
                    { question: 'The _____ news from the CEO surprised everyone.', options: ['announcing', 'announced', 'announce', 'announces'], correct: 1, explanation: 'éå»åˆ†è©ä¿®é£¾åè©ã€‚' },
                    { question: 'We are _____ to hear about the success.', options: ['excited', 'exciting', 'excite', 'excites'], correct: 0, explanation: 'äººè¢«å‹•æ™‚ç”¨éå»åˆ†è©ã€‚' },
                    { question: 'The story was very _____.', options: ['interested', 'interesting', 'interest', 'interests'], correct: 1, explanation: 'ç¾åœ¨åˆ†è©ä¿®é£¾äº‹ç‰©ã€‚' },
                    { question: 'The _____ customers waited in line.', options: ['annoyed', 'annoying', 'annoy', 'annoys'], correct: 0, explanation: 'éå»åˆ†è©è¡¨ç¤ºè¢«æƒ¹æƒ±çš„äººã€‚' },
                    { question: 'This is an _____ opportunity for growth.', options: ['excite', 'excited', 'exciting', 'excitement'], correct: 2, explanation: 'ç¾åœ¨åˆ†è©ä¿®é£¾åè©ï¼Œè¡¨ç¤ºä»¤äººèˆˆå¥®çš„ã€‚' },
                    { question: 'The _____ letter contained important information.', options: ['attach', 'attached', 'attaching', 'attachment'], correct: 1, explanation: 'éå»åˆ†è©ä½œå®šèªã€‚' },
                    { question: 'The lecture was so _____ that many students fell asleep.', options: ['boring', 'bored', 'bore', 'bores'], correct: 0, explanation: 'äº‹ç‰©ç”¨boringã€‚' },
                    { question: 'She felt very _____ after the long meeting.', options: ['tired', 'tiring', 'tire', 'tires'], correct: 0, explanation: 'äººæ„Ÿåˆ°ç–²å€¦ç”¨tiredã€‚' },
                    { question: 'The _____ presentation impressed the investors.', options: ['compelling', 'compel', 'compelled', 'compels'], correct: 0, explanation: 'ç¾åœ¨åˆ†è©ä¿®é£¾åè©ã€‚' },
                    { question: 'All _____ employees will receive bonuses.', options: ['qualify', 'qualified', 'qualifying', 'qualifies'], correct: 1, explanation: 'éå»åˆ†è©ä½œå®šèªã€‚' },
                    { question: 'The _____ documents need to be filed.', options: ['sign', 'signed', 'signing', 'signs'], correct: 1, explanation: 'éå»åˆ†è©è¡¨è¢«å‹•ã€‚' },
                    { question: 'This is a very _____ software program.', options: ['use', 'useful', 'using', 'used'], correct: 1, explanation: 'å½¢å®¹è©ä¿®é£¾åè©ã€‚' },
                    { question: 'The _____ student worked very hard.', options: ['motivate', 'motivated', 'motivating', 'motivates'], correct: 1, explanation: 'éå»åˆ†è©è¡¨è¢«å‹•å«ç¾©ã€‚' },
                    { question: 'The _____ workshop was very informative.', options: ['organize', 'organized', 'organizing', 'organizes'], correct: 1, explanation: 'éå»åˆ†è©ä½œå®šèªã€‚' },
                    { question: 'The _____ children played happily.', options: ['excite', 'excited', 'exciting', 'excites'], correct: 1, explanation: 'éå»åˆ†è©è¡¨è¢«å‹•å«ç¾©ã€‚' }
                ]
            },
            {
                topic: 'é€£æ¥è© vs ä»‹ç³»è©',
                questions: [
                    { question: '_____ the difficult circumstances, the team remained productive.', options: ['Although', 'Despite', 'However', 'Because of'], correct: 1, explanation: 'Despiteæ˜¯ä»‹ç³»è©ã€‚' },
                    { question: 'We completed the task _____ it rained heavily.', options: ['despite', 'although', 'in spite of', 'because'], correct: 1, explanation: 'å®Œæ•´å­å¥ç”¨é€£æ¥è©althoughã€‚' },
                    { question: '_____ the budget increase, we cannot approve it.', options: ['In spite of', 'Even though', 'Because', 'For'], correct: 0, explanation: 'in spite ofæ˜¯ä»‹ç³»è©ã€‚' },
                    { question: 'The company expanded _____ increasing demand.', options: ['because', 'due to', 'although', 'unless'], correct: 1, explanation: 'due toæ˜¯ä»‹ç³»è©çŸ­èªã€‚' },
                    { question: '_____ the rain, the event was successful.', options: ['Despite of', 'In spite of', 'Although', 'Because'], correct: 1, explanation: 'in spite ofæ˜¯æ­£ç¢ºçŸ­èªã€‚' },
                    { question: 'He succeeded _____ his lack of experience.', options: ['despite', 'although', 'even if', 'whereas'], correct: 0, explanation: 'despiteå¾Œæ¥åè©ã€‚' },
                    { question: 'She got the job _____ she had strong qualifications.', options: ['because of', 'because', 'due to', 'however'], correct: 1, explanation: 'å®Œæ•´å­å¥ç”¨becauseã€‚' },
                    { question: '_____ working late, he finished the report.', options: ['By', 'Through', 'Despite', 'Unless'], correct: 2, explanation: 'despiteå¾Œæ¥å‹•åè©ã€‚' },
                    { question: 'The project failed _____ poor planning.', options: ['because of', 'because', 'although', 'unless'], correct: 0, explanation: 'because ofå¾Œæ¥åè©ã€‚' },
                    { question: '_____ his efforts, he could not finish on time.', options: ['Despite', 'Although', 'Because', 'Unless'], correct: 0, explanation: 'despiteå¾Œæ¥åè©ã€‚' }
                ]
            }
        ];

        // ===== è³‡æ–™åº«ï¼šè©å½™ï¼ˆå¾è‹±æ–‡è³‡æ–™åº«åˆä½µï¼‰ =====
        const vocabularyData = [
            // B2é€²éšè©å½™
            { word: 'proficiency', pronunciation: '/prÉ™ËˆfÉªÊƒÉ™nsi/', meaning: 'ç†Ÿç·´åº¦ã€ç²¾é€š', example: 'Language proficiency is essential for international business.' },
            { word: 'coherent', pronunciation: '/koÊŠËˆhÉªrÉ™nt/', meaning: 'é€£è²«çš„ã€æ¸…æ™°çš„', example: 'Your essay should have a coherent structure.' },
            { word: 'elaborate', pronunciation: '/ÉªËˆlÃ¦bÉ™rÉ™t/', meaning: 'è©³ç´°èªªæ˜ã€è©³ç´°çš„', example: 'Can you elaborate on your previous point?' },
            { word: 'concise', pronunciation: '/kÉ™nËˆsaÉªs/', meaning: 'ç°¡æ˜çš„ã€ç°¡æ½”çš„', example: 'Write a concise summary of the article.' },
            { word: 'nuance', pronunciation: '/ËˆnuËÉ‘Ëns/', meaning: 'ç´°å¾®å·®åˆ¥ã€ç´°ç¯€', example: 'B2 learners should understand the nuances of English grammar.' },
            { word: 'pragmatic', pronunciation: '/prÃ¦É¡ËˆmÃ¦tÉªk/', meaning: 'å¯¦ç”¨ä¸»ç¾©çš„ã€å¯¦éš›çš„', example: 'Take a pragmatic approach to language learning.' },

            // TOEICå¸¸è€ƒå•†å‹™è©å½™
            { word: 'commitment', pronunciation: '/kÉ™ËˆmÉªtmÉ™nt/', meaning: 'æ‰¿è«¾ã€æŠ•å…¥ã€è²¬ä»»', example: 'Our company shows strong commitment to customer satisfaction.' },
            { word: 'optimize', pronunciation: '/ËˆÉ’ptÉªmaÉªz/', meaning: 'å„ªåŒ–ã€æ”¹å–„', example: 'We need to optimize our production process to increase efficiency.' },
            { word: 'facilitate', pronunciation: '/fÉ™ËˆsÉªlÉªteÉªt/', meaning: 'ä¾¿åˆ©ã€ä¿ƒé€²ã€å¹«åŠ©', example: 'This new software will facilitate better communication among teams.' },
            { word: 'allocate', pronunciation: '/ËˆÃ¦lÉ™keÉªt/', meaning: 'åˆ†é…ã€æ’¥æ¬¾', example: 'The budget will be allocated to different departments.' },
            { word: 'implement', pronunciation: '/ËˆÉªmplÉ™ment/', meaning: 'å¯¦æ–½ã€åŸ·è¡Œã€å·¥å…·', example: 'We will implement the new strategy next quarter.' },
            { word: 'coordinate', pronunciation: '/koÊŠËˆÉ”ËrdÉªneÉªt/', meaning: 'å”èª¿ã€é…åˆ', example: 'Please coordinate with the HR department on this project.' },
            { word: 'profitability', pronunciation: '/ËŒprÉ’fÉªtÉ™ËˆbÉªlÉ™ti/', meaning: 'ç²åˆ©èƒ½åŠ›ã€ç›ˆåˆ©æ€§', example: 'The company\'s profitability has improved significantly.' },
            { word: 'productivity', pronunciation: '/prÉ™ËˆdÊŒktÉªvÉªti/', meaning: 'ç”Ÿç”¢åŠ›ã€æ•ˆç‡', example: 'Improving workplace conditions can boost employee productivity.' },
            { word: 'competent', pronunciation: '/ËˆkÉ’mpÉªtÉ™nt/', meaning: 'æœ‰èƒ½åŠ›çš„ã€å‹ä»»çš„', example: 'All our staff members are highly competent professionals.' },
            { word: 'reliable', pronunciation: '/rÉªËˆlaÉªÉ™bl/', meaning: 'å¯é çš„ã€å€¼å¾—ä¿¡ä»»çš„', example: 'We need a reliable supplier for our manufacturing.' },
            { word: 'obsolete', pronunciation: '/ËŒÉ’bsÉ™ËˆliËt/', meaning: 'éæ™‚çš„ã€å»¢æ£„çš„', example: 'The old equipment has become obsolete.' },
            { word: 'leverage', pronunciation: '/ËˆlevÉ™rÉªdÊ’/', meaning: 'é‹ç”¨ã€åˆ©ç”¨ã€æ§“æ¡¿', example: 'We can leverage our resources to enter new markets.' },

            // TOEICå¸¸è€ƒæ—¥å¸¸è©å½™
            { word: 'agenda', pronunciation: '/É™ËˆdÊ’endÉ™/', meaning: 'è­°ç¨‹ã€æ—¥ç¨‹', example: 'The meeting agenda includes budget planning and staff updates.' },
            { word: 'correspond', pronunciation: '/ËŒkÉ’rÉªËˆspÉ’nd/', meaning: 'é€šä¿¡ã€ç¬¦åˆã€ç›¸ç•¶', example: 'Please correspond with our partner about the shipment date.' },
            { word: 'transaction', pronunciation: '/trÃ¦nËˆzÃ¦kÊƒÉ™n/', meaning: 'äº¤æ˜“ã€äº‹å‹™', example: 'All financial transactions must be recorded properly.' },
            { word: 'eligible', pronunciation: '/ËˆelÉªdÊ’É™bl/', meaning: 'æœ‰è³‡æ ¼çš„ã€åˆæ ¼çš„', example: 'Only employees with two years of service are eligible for bonuses.' },
            { word: 'substantial', pronunciation: '/sÉ™bËˆstÃ¦nÊƒÉ™l/', meaning: 'å¤§é‡çš„ã€å¯¦è³ªçš„ã€å …å›ºçš„', example: 'The project requires a substantial budget investment.' },
            { word: 'versatile', pronunciation: '/ËˆvÉœËrsÉ™tÉ‘ËÉªl/', meaning: 'å¤šæ‰å¤šè—çš„ã€å¤šç”¨é€”çš„', example: 'This software is very versatile and can handle various tasks.' }
        ];

        // ===== ä½¿ç”¨è€…èˆ‡ localStorage key å·¥å…·å‡½å¼ =====
        let currentUser = localStorage.getItem('currentEnglishUser') || 'guest';
        let allUsers = JSON.parse(localStorage.getItem('allEnglishUsers') || '["guest"]');

        function getStorageKey(key) {
            return `english_${currentUser}_${key}`;
        }

        function updateCurrentUserDisplay() {
            const el = document.getElementById('currentUserDisplay');
            if (el) el.textContent = `ğŸ‘¤ ${currentUser}`;
        }

        function openUserModal() {
            const modal = document.getElementById('userModal');
            const list = document.getElementById('userList');
            if (!modal || !list) return;
            list.innerHTML = '';
            allUsers.forEach(user => {
                const div = document.createElement('div');
                div.className = 'user-item' + (user === currentUser ? ' active' : '');
                div.textContent = user;
                div.onclick = () => switchUser(user);
                list.appendChild(div);
            });
            modal.classList.add('show');
        }

        function closeUserModal() {
            const modal = document.getElementById('userModal');
            if (modal) modal.classList.remove('show');
        }

        function switchUser(userName) {
            currentUser = userName;
            localStorage.setItem('currentEnglishUser', currentUser);
            updateCurrentUserDisplay();
            closeUserModal();
            updateStats();
            loadDailyExercises();
            performDailyCheckIn();
            loadVocabularyForToday();
        }

        function createNewUser() {
            const input = document.getElementById('newUserInput');
            const userName = input.value.trim();
            if (userName && !allUsers.includes(userName)) {
                allUsers.push(userName);
                localStorage.setItem('allEnglishUsers', JSON.stringify(allUsers));
                switchUser(userName);
                input.value = '';
            }
        }

        // ===== æ–‡æ³•æ¸¬é©—åˆå§‹åŒ–èˆ‡æª¢æŸ¥ =====
        function loadGrammarQuizzes() {
            grammarData.forEach((topic, index) => {
                const container = document.getElementById(`grammarQuiz${index}`);
                if (container) {
                    const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
                    const question = topic.questions[dayOfYear % topic.questions.length];
                    container.innerHTML = `
                        <div class="grammar-question">
                            <p style="margin-bottom: 12px;"><strong>é¡Œç›®ï¼š</strong> ${question.question}</p>
                            <div class="grammar-options" id="options${index}">
                                ${question.options.map((opt, i) => `
                                    <label class="option">
                                        <input type="radio" name="grammar${index}" value="${i}" onchange="checkGrammar(${index}, ${i}, ${question.correct}, '${question.explanation}')">
                                        ${opt}
                                    </label>
                                `).join('')}
                            </div>
                            <div id="grammarFeedback${index}"></div>
                        </div>
                    `;
                }
            });
        }

        function checkGrammar(quizIndex, selectedIndex, correctIndex, explanation) {
            const feedback = document.getElementById(`grammarFeedback${quizIndex}`);
            if (!feedback) return;
            if (selectedIndex === correctIndex) {
                feedback.innerHTML = `<div class="feedback success">âœ… æ­£ç¢ºï¼${explanation}</div>`;
                incrementStats('grammarScore');
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ ${explanation}</div>`;
            }
        }

        // ===== æ¯æ—¥æ‰“å¡ç³»çµ± =====
        function performDailyCheckIn() {
            const today = new Date().toDateString();
            const lastCheckIn = localStorage.getItem(getStorageKey('lastCheckIn'));
            if (lastCheckIn !== today) {
                localStorage.setItem(getStorageKey('lastCheckIn'), today);
                let stats = JSON.parse(localStorage.getItem(getStorageKey('englishStats')) || '{}');
                stats.dayCount = (stats.dayCount || 0) + 1;

                const lastStreak = localStorage.getItem(getStorageKey('lastStreakDate'));
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);

                if (lastStreak === yesterday.toDateString()) {
                    stats.streak = (stats.streak || 0) + 1;
                } else {
                    stats.streak = 1;
                }

                localStorage.setItem(getStorageKey('lastStreakDate'), today);
                localStorage.setItem(getStorageKey('englishStats'), JSON.stringify(stats));
                updateStats();
            }
        }

        // ===== çµ±è¨ˆæ•¸å€¼è™•ç† =====
        function incrementStats(field) {
            let stats = JSON.parse(localStorage.getItem(getStorageKey('englishStats')) || '{}');
            stats[field] = (stats[field] || 0) + 1;
            localStorage.setItem(getStorageKey('englishStats'), JSON.stringify(stats));
            updateStats();
        }

        function updateStats() {
            let stats = JSON.parse(localStorage.getItem(getStorageKey('englishStats')) || '{}');
            document.getElementById('dayCount').textContent = stats.dayCount || 0;
            document.getElementById('wordCount').textContent = stats.wordCount || 0;
            document.getElementById('writingCount').textContent = stats.writingCount || 0;
            document.getElementById('streak').textContent = stats.streak || 0;
        }

        // ===== æ¯é€±è¡Œç¨‹æ¸²æŸ“ =====
        function renderSchedule() {
            const container = document.getElementById('scheduleContent');
            if (!container) return;
            container.innerHTML = '';
            scheduleData.forEach(item => {
                const div = document.createElement('div');
                div.className = 'schedule-day';
                div.innerHTML = `
                    <h4>${item.day}ï½œ${item.theme}</h4>
                    <p>é‡é»ï¼š${item.focus}</p>
                    <p>é—œéµè©ï¼š${item.keywords}</p>
                `;
                container.appendChild(div);
            });
        }

        // ===== å¯«ä½œé¡Œç›®è¼‰å…¥ =====
        function loadDailyExercises() {
            const todayIndex = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);

            const ex1 = writingExercisesBank.level1[todayIndex % writingExercisesBank.level1.length];
            const ex2 = writingExercisesBank.level2[todayIndex % writingExercisesBank.level2.length];
            const ex3 = writingExercisesBank.level3[todayIndex % writingExercisesBank.level3.length];

            document.getElementById('ex1Question').textContent = ex1.question;
            document.getElementById('ex1Hint').textContent = ex1.hint;

            document.getElementById('ex2Topic').textContent = ex2.topic;
            document.getElementById('ex2Keywords').textContent = ex2.keywords;

            document.getElementById('ex3Topic').textContent = ex3.topic;
        }

        function checkLevel1() {
            const answer = document.getElementById('answer1').value.trim();
            const feedback = document.getElementById('feedback1');

            if (!answer) {
                feedback.innerHTML = '<div class="feedback error">âŒ è«‹è¼¸å…¥ç­”æ¡ˆ</div>';
                return;
            }

            const hasConnector = ['after', 'before', 'when', 'because', 'although', 'while', 'since', 'so', 'though']
                .some(word => answer.toLowerCase().includes(word));

            if (hasConnector && answer.length > 30) {
                feedback.innerHTML = `<div class="feedback success">âœ… å¾ˆå¥½ï¼ä½ æˆåŠŸçµ„åˆäº†å¥å­ã€‚é€™æ˜¯B2ç´šåˆ¥çš„å¥å­çµæ§‹ã€‚</div>`;
                incrementStats('wordCount');
                incrementStats('writingCount');
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ è©¦è‘—ä½¿ç”¨é€£æ¥è©(because, after, when, althoughç­‰)ä¾†çµ„åˆå¥å­ã€‚</div>`;
            }
        }

        function checkLevel2() {
            const answer = document.getElementById('answer2').value.trim();
            const feedback = document.getElementById('feedback2');
            const sentences = answer.split('.').filter(s => s.trim());

            if (!answer) {
                feedback.innerHTML = '<div class="feedback error">âŒ è«‹è¼¸å…¥ç­”æ¡ˆ</div>';
                return;
            }

            if (sentences.length >= 3 && sentences.length <= 6 && answer.length > 60) {
                feedback.innerHTML = `<div class="feedback success">âœ… å„ªç§€ï¼ä½ å¯«å‡ºäº†ä¸€å€‹çµæ§‹è‰¯å¥½çš„æ®µè½ã€‚åŒ…å«ä¸»é¡Œå¥å’Œæ”¯æŒå¥ã€‚</div>`;
                incrementStats('writingCount');
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ ä¸€å€‹å¥½æ®µè½æ‡‰è©²æœ‰3-5å€‹å¥å­ï¼Œä¸¦ä¸”åœç¹ä¸€å€‹ä¸»é¡Œå±•é–‹ã€‚</div>`;
            }
        }

        function checkLevel3() {
            const answer = document.getElementById('answer3').value.trim();
            const feedback = document.getElementById('feedback3');
            const words = answer.split(/\s+/).filter(w => w.length > 0).length;

            if (!answer) {
                feedback.innerHTML = '<div class="feedback error">âŒ è«‹è¼¸å…¥ç­”æ¡ˆ</div>';
                return;
            }

            if (words >= 150 && words <= 220) {
                feedback.innerHTML = `<div class="feedback success">âœ… å¾ˆæ£’ï¼ä½ çš„çŸ­æ–‡å­—æ•¸é©ä¸­ï¼Œé©åˆB2ç´šåˆ¥ç·´ç¿’ã€‚</div>`;
                incrementStats('writingCount');
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ è«‹å°‡å­—æ•¸æ§åˆ¶åœ¨150-200å­—ä¹‹é–“ï¼Œç›®å‰ç´„ç‚º ${words} å­—ã€‚</div>`;
            }
        }

        // ===== è©å½™æ¯æ—¥è¼‰å…¥ =====
        function loadVocabularyForToday() {
            const container = document.getElementById('vocabularyList');
            if (!container) return;
            container.innerHTML = '';

            const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
            const startIndex = (dayOfYear * 5) % vocabularyData.length;

          const todayWords = [
    vocabularyData[startIndex],
    vocabularyData[(startIndex + 1) % vocabularyData.length],
    vocabularyData[(startIndex + 2) % vocabularyData.length],
    vocabularyData[(startIndex + 3) % vocabularyData.length],
    vocabularyData[(startIndex + 4) % vocabularyData.length]
];

            todayWords.forEach((item, idx) => {
                if (!item) return;
                const div = document.createElement('div');
                div.className = 'vocabulary-card';
                div.innerHTML = `
                    <div class="word">
                        ${item.word}
                        <button class="play-btn" onclick="playPronunciation('${item.word}', this)">â–¶</button>
                    </div>
                    <div class="pronunciation">${item.pronunciation}</div>
                    <div class="meaning">${item.meaning}</div>
                    <div class="example">${item.example}</div>
                `;
                container.appendChild(div);
            });
        }

        function playPronunciation(text, btn) {
            if (!window.speechSynthesis) return;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';

            btn.classList.add('playing');
            speechSynthesis.cancel();
            speechSynthesis.speak(utterance);
            utterance.onend = () => {
                btn.classList.remove('playing');
            };
        }

        // ===== é ç±¤åˆ‡æ› =====
        function switchGrammarTab(index) {
            document.querySelectorAll('#grammarTabs .tab').forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });
            document.querySelectorAll('#grammarContent .tab-content').forEach((content, i) => {
                content.classList.toggle('active', i === index);
            });
        }

        function switchWritingTab(index) {
            document.querySelectorAll('#writingTabs .tab').forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });
            document.querySelectorAll('#writingContent .tab-content').forEach((content, i) => {
                content.classList.toggle('active', i === index);
            });
        }

        // ===== æ—¥æœŸé¡¯ç¤ºèˆ‡æœªä¾†é è¦½ =====
        function updateDateDisplay() {
            const el = document.getElementById('dateDisplay');
            if (!el) return;
            const today = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            el.textContent = 'ğŸ“… ä»Šå¤©ï¼š' + today.toLocaleDateString('zh-TW', options);
        }

        function previewFutureDay() {
            const modal = document.getElementById('previewModal');
            if (modal) modal.classList.add('show');
        }

        function closePreviewModal() {
            const modal = document.getElementById('previewModal');
            if (modal) modal.classList.remove('show');
        }

        function loadPreviewContent() {
            const dateInput = document.getElementById('previewDate');
            const preview = document.getElementById('previewContent');
            if (!dateInput || !preview || !dateInput.value) return;

            const selectedDate = new Date(dateInput.value);
            const dayOfYear = Math.floor((selectedDate - new Date(selectedDate.getFullYear(), 0, 0)) / 86400000);

            const ex1 = writingExercisesBank.level1[dayOfYear % writingExercisesBank.level1.length];
            const ex2 = writingExercisesBank.level2[dayOfYear % writingExercisesBank.level2.length];
            const ex3 = writingExercisesBank.level3[dayOfYear % writingExercisesBank.level3.length];

            const startIndex = (dayOfYear * 3) % vocabularyData.length;
            const words = [
                vocabularyData[startIndex],
                vocabularyData[(startIndex + 1) % vocabularyData.length],
                vocabularyData[(startIndex + 2) % vocabularyData.length]
            ];

            preview.innerHTML = `
                <h4 style="color: var(--primary); margin-bottom: 10px;">ğŸ“Œ é è¦½æ—¥æœŸï¼š${dateInput.value}</h4>
                <div style="margin-bottom: 10px;">
                    <strong>å¥å­çµ„åˆï¼š</strong> ${ex1.question}<br>
                    <span style="color: var(--text-light);">Hint: ${ex1.hint}</span>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>æ®µè½å¯«ä½œä¸»é¡Œï¼š</strong> ${ex2.topic}<br>
                    <strong>é—œéµè©ï¼š</strong> ${ex2.keywords}
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>çŸ­æ–‡ä¸»é¡Œï¼š</strong> ${ex3.topic}
                </div>
                <div>
                    <strong>ç•¶æ—¥å–®å­—é è¦½ï¼š</strong>
                    <ul>
                        ${words.map(w => w ? `<li>${w.word} - ${w.meaning}</li>` : '').join('')}
                    </ul>
                </div>
            `;
        }

        // ===== å¯«ä½œå€å­—æ•¸çµ±è¨ˆ =====
        document.addEventListener('input', function (e) {
            if (e.target && e.target.id === 'answer3') {
                const words = e.target.value.split(/\s+/).filter(w => w.length > 0).length;
                const counter = document.getElementById('wordCounter');
                if (counter) counter.textContent = words;
            }
        });

        // ===== åˆå§‹åŒ– =====
        window.addEventListener('load', () => {
            updateCurrentUserDisplay();
            updateStats();
            performDailyCheckIn();
            renderSchedule();
            loadDailyExercises();
            loadGrammarQuizzes();
            loadVocabularyForToday();
            updateDateDisplay();
        });
    </script>
</body>
</html>
