<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±èªå­¸ç¿’å¹³å° - B1â†’B2é€²éš</title>
    <style>
        :root {
            --primary: #F5C197;
            --primary-hover: #E8B382;
            --success: #F0B8A8;
            --warning: #FDD9BE;
            --danger: #E8A88E;
            --bg: #FFFEF8;
            --surface: #F5E8D9;
            --text: #5C4A42;
            --text-light: #9A8B81;
            --border: #E0CDB9;
            --accent-light: #FFFEF8;
            --accent-warm: #F5E8D9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), #E8B382);
            color: #5C4A42;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .header-left {
            flex: 1;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .user-controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .current-user {
            background: rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 14px;
        }

        .user-btn {
            background: rgba(255,255,255,0.4);
            color: #5C4A42;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: background 0.3s ease;
        }

        .user-btn:hover {
            background: rgba(255,255,255,0.6);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--surface);
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .modal-content h3 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .user-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .user-item {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            cursor: pointer;
            border-left: 4px solid var(--primary);
            transition: background 0.3s ease;
        }

        .user-item:hover {
            background: #f5f5f5;
        }

        .user-item.active {
            background: #fffaeb;
            font-weight: 500;
        }

        .user-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .modal-close {
            background: var(--border);
            color: var(--text);
        }

        .modal-close:hover {
            background: #d0d0d0;
        }

        .modal-confirm {
            background: var(--primary);
            color: white;
        }

        .modal-confirm:hover {
            background: var(--primary-hover);
        }

        .stat-card {
            background: linear-gradient(135deg, #F5C197 0%, #E8B382 100%);
            color: #5C4A42;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }

        .grammar-question {
            background: white;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary);
        }

        .grammar-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }

        .option {
            background: #FFFEF8;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: var(--primary);
            background: #fffaeb;
        }

        .option input[type="radio"] {
            margin-right: 8px;
        }

        .option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .grammar-explanation {
            background: #FFF5E6;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid var(--warning);
            font-size: 13px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }

        .section {
            background: var(--surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.8);
            border: 1px solid var(--border);
        }

        .section h2 {
            font-size: 20px;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .tab {
            padding: 12px 16px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-light);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .schedule-day {
            background: #FFFEF8;
            border-left: 5px solid var(--primary);
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-top: 1px solid var(--border);
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .schedule-day h4 {
            color: var(--primary);
            margin-bottom: 6px;
        }

        .schedule-day p {
            font-size: 14px;
            color: var(--text-light);
            margin: 4px 0;
        }

        .study-blocks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .block {
            background: linear-gradient(135deg, #F5C197 0%, #E8B382 100%);
            color: #5C4A42;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .block.input {
            background: linear-gradient(135deg, #F5C197 0%, #E8B382 100%);
        }

        .block.output {
            background: linear-gradient(135deg, #EDB89F 0%, #E3A88B 100%);
        }

        .block.integration {
            background: linear-gradient(135deg, #FDD9BE 0%, #F5C9B0 100%);
        }

        .block h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .block-time {
            font-size: 28px;
            font-weight: bold;
            margin: 12px 0;
        }

        .block-desc {
            font-size: 13px;
            opacity: 0.95;
        }

        .writing-exercise {
            background: #FFFEF8;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            border: 1px solid var(--border);
        }

        .writing-exercise h4 {
            color: var(--primary);
            margin-bottom: 8px;
        }

        .writing-exercise .example {
            background: white;
            padding: 10px;
            border-left: 3px solid var(--warning);
            margin: 8px 0;
            font-size: 13px;
            border-radius: 4px;
        }

        .writing-exercise .tips {
            background: #FFFEF8;
            padding: 10px;
            border-radius: 4px;
            font-size: 13px;
            color: #9A8B81;
            margin-top: 8px;
            border-left: 3px solid var(--primary);
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 10px;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(245, 193, 151, 0.2);
        }

        .btn {
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-hover);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #388E3C;
        }

        .feedback {
            margin-top: 12px;
            padding: 12px;
            border-radius: 6px;
            font-size: 13px;
        }

        .feedback.error {
            background: #FFE8DC;
            color: #E8A88E;
            border-left: 4px solid #E8A88E;
        }

        .feedback.success {
            background: #FFFAEB;
            color: #F0B8A8;
            border-left: 4px solid #F0B8A8;
        }

        .feedback.info {
            background: #FFF5E6;
            color: #9A8B81;
            border-left: 4px solid #9A8B81;
        }

        .progress-section {
            margin-top: 20px;
        }

        .progress-item {
            margin-bottom: 12px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .vocabulary-card {
            background: #FFFEF8;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 5px solid var(--primary);
            border-top: 1px solid var(--border);
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .vocabulary-card .word {
            font-weight: bold;
            color: var(--primary);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .play-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease, transform 0.2s ease;
            flex-shrink: 0;
        }

        .play-btn:hover {
            background: var(--primary-hover);
            transform: scale(1.1);
        }

        .play-btn:active {
            transform: scale(0.95);
        }

        .play-btn.playing {
            background: var(--success);
            animation: pulse 0.6s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .vocabulary-card .pronunciation {
            font-style: italic;
            color: var(--text-light);
            font-size: 13px;
        }

        .vocabulary-card .meaning {
            margin-top: 6px;
            color: var(--text);
        }

        .vocabulary-card .example {
            margin-top: 6px;
            color: var(--text-light);
            font-size: 13px;
            border-left: 2px solid var(--warning);
            padding-left: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }

            .study-blocks {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>ğŸ¯ è‹±èªå­¸ç¿’å¹³å°</h1>
            <p>B1â†’B2 é€²éšèª²ç¨‹ | æ¯æ—¥15åˆ†é˜é›†ä¸­å­¸ç¿’</p>
            <p id="dateDisplay" style="font-size: 12px; opacity: 0.8; margin-top: 5px;">ğŸ“… ä»Šå¤©çš„æ—¥æœŸ</p>
        </div>
        <div class="user-controls">
            <div class="current-user" id="currentUserDisplay">ğŸ‘¤ éŠå®¢</div>
            <button class="user-btn" onclick="openUserModal()">ğŸ‘¥ åˆ‡æ›ç”¨æˆ¶</button>
            <button class="user-btn" onclick="previewFutureDay()">ğŸ“‹ æŸ¥çœ‹é è¦½</button>
        </div>
    </div>

    <!-- ç”¨æˆ¶ç®¡ç†æ¨¡æ…‹æ¡† -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <h3>ğŸ‘¥ ç”¨æˆ¶ç®¡ç†</h3>
            <div class="user-list" id="userList"></div>
            <input type="text" id="newUserInput" class="user-input" placeholder="è¼¸å…¥æ–°ç”¨æˆ¶å...">
            <div class="modal-buttons">
                <button class="modal-close" onclick="closeUserModal()">å–æ¶ˆ</button>
                <button class="modal-confirm" onclick="createNewUser()">æ–°å»ºç”¨æˆ¶</button>
            </div>
        </div>
    </div>

    <!-- æ—¥æœŸé è¦½æ¨¡æ…‹æ¡† -->
    <div id="previewModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3>ğŸ“… æœªä¾†æ—¥æœŸå…§å®¹é è¦½</h3>
            <div style="margin-bottom: 20px;">
                <div style="margin-bottom: 15px;">
                    <label style="font-weight: 500; color: var(--primary); display: block; margin-bottom: 8px;">é¸æ“‡æ—¥æœŸï¼š</label>
                    <input type="date" id="previewDate" style="width: 100%; padding: 10px; border: 2px solid var(--border); border-radius: 6px; font-size: 14px;">
                </div>
                <button class="btn" onclick="loadPreviewContent()" style="width: 100%; margin-bottom: 15px;">é è¦½è©²æ—¥æœŸå…§å®¹</button>
            </div>
            <div id="previewContent" style="background: white; padding: 15px; border-radius: 6px; max-height: 400px; overflow-y: auto;"></div>
            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="modal-close" onclick="closePreviewModal()" style="flex: 1;">é—œé–‰</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- çµ±è¨ˆé¢æ¿ -->
        <div class="section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="dayCount">0</div>
                    <div class="stat-label">å­¸ç¿’å¤©æ•¸</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #EDB89F 0%, #E3A88B 100%);">
                    <div class="stat-number" id="wordCount">0</div>
                    <div class="stat-label">æ–°å–®å­—</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #FDD9BE 0%, #F5C9B0 100%);">
                    <div class="stat-number" id="writingCount">0</div>
                    <div class="stat-label">å¯«ä½œç¯‡æ•¸</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #F0B8A8 0%, #E8A88E 100%);">
                    <div class="stat-number" id="streak">0</div>
                    <div class="stat-label">é€£çºŒå¤©æ•¸</div>
                </div>
            </div>
        </div>

        <!-- 5-5-5 å­¸ç¿’æ–¹æ³• -->
        <div class="section">
            <h2>â±ï¸ æ¯æ—¥5-5-5å­¸ç¿’æ–¹æ³•</h2>
            <div class="study-blocks">
                <div class="block input">
                    <h3>ğŸ“» Block 1: è½åŠ›è¼¸å…¥</h3>
                    <div class="block-time">5 åˆ†é˜</div>
                    <div class="block-desc">
                        æ’­æ”¾è‹±æ–‡å°è©±ã€TEDæ¼”è¬›æˆ–æ–°èç‰‡æ®µ
                        <br><small>æå‡è½åŠ›ç†è§£èƒ½åŠ›</small>
                    </div>
                </div>
                <div class="block output">
                    <h3>ğŸ¤ Block 2: å£èªªè¼¸å‡º</h3>
                    <div class="block-time">5 åˆ†é˜</div>
                    <div class="block-desc">
                        è·Ÿè®€ã€è‡ªç”±æ¼”è¬›æˆ–å°è©±ç·´ç¿’
                        <br><small>åŸ¹é¤Šå£èªªæµæš¢åº¦</small>
                    </div>
                </div>
                <div class="block integration">
                    <h3>âœï¸ Block 3: å¯«ä½œæ•´åˆ</h3>
                    <div class="block-time">5 åˆ†é˜</div>
                    <div class="block-desc">
                        å¾®å¯«ä½œç·´ç¿’ã€å¥å­çµ„ç¹”
                        <br><small>å¼·åŒ–å¯«ä½œè¡¨é”èƒ½åŠ›</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ¯é€±å­¸ç¿’è¨ˆåŠƒ -->
        <div class="section">
            <h2>ğŸ“… æ¯é€±å­¸ç¿’ä¸»é¡Œè¨ˆåŠƒ</h2>
            <div id="scheduleContent"></div>
        </div>

        <!-- æ–‡æ³•å­¸ç¿’æ ¸å¿ƒ -->
        <div class="section">
            <h2>ğŸ“– B2 é€²éšæ–‡æ³•å­¸ç¿’</h2>
            
            <div class="tabs" id="grammarTabs">
                <button class="tab active" onclick="switchGrammarTab(0)">ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼</button>
                <button class="tab" onclick="switchGrammarTab(1)">ä»‹ç³»è©æ‡‰ç”¨</button>
                <button class="tab" onclick="switchGrammarTab(2)">è©æ€§è¾¨æ</button>
                <button class="tab" onclick="switchGrammarTab(3)">ä¸»è©å‹•è©ä¸€è‡´</button>
                <button class="tab" onclick="switchGrammarTab(4)">è™›æ“¬èªæ°£é€²éš</button>
            </div>

            <div id="grammarContent">
            <!-- ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼ -->
            <div class="tab-content active" id="grammarTab0">
                <div class="writing-exercise">
                    <h4>ğŸ“– ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼</h4>
                    <div class="grammar-explanation">
                        <strong>ç¾åœ¨å®Œæˆå¼ (Present Perfect):</strong> ç”¨æ–¼æè¿°å¾éå»åˆ°ç¾åœ¨ä»æœ‰å½±éŸ¿çš„è¡Œç‚ºã€‚<br>
                        <strong>éå»å®Œæˆå¼ (Past Perfect):</strong> ç”¨æ–¼æè¿°æ¯”å¦ä¸€å€‹éå»äº‹ä»¶æ›´æ—©ç™¼ç”Ÿçš„è¡Œç‚ºã€‚<br><br>
                        ä¾‹å¥ï¼š<br>
                        â€¢ I <strong>have lived</strong> here for 5 years. (æˆ‘ä½åœ¨é€™è£¡5å¹´äº†ï¼Œç¾åœ¨ä»ä½åœ¨é€™è£¡)<br>
                        â€¢ I <strong>had lived</strong> here for 5 years when I moved. (æˆ‘æ¬å®¶å‰ä½äº†5å¹´)
                    </div>
                    <div id="grammarQuiz0"></div>
                </div>
            </div>

            <!-- ä»‹ç³»è©æ‡‰ç”¨ -->
            <div class="tab-content" id="grammarTab1">
                <div class="writing-exercise">
                    <h4>ğŸ“– ä»‹ç³»è©æ‡‰ç”¨</h4>
                    <div class="grammar-explanation">
                        <strong>ä»‹ç³»è©ç”¨é€”ï¼š</strong><br>
                        â€¢ <strong>for:</strong> è¡¨ç¤ºç›®çš„ã€æŒçºŒæ™‚é–“ (responsible for, look forward to)<br>
                        â€¢ <strong>on:</strong> è¡¨ç¤ºå…·é«”æ—¥æœŸã€é—œæ–¼ (on June 15th, focus on)<br>
                        â€¢ <strong>in:</strong> è¡¨ç¤ºèˆˆè¶£ã€æ™‚é–“æ®µ (interested in, in June)<br><br>
                        ä¾‹å¥ï¼š<br>
                        â€¢ The manager is responsible <strong>for</strong> the entire project.<br>
                        â€¢ We are looking forward <strong>to</strong> your arrival next week.
                    </div>
                    <div id="grammarQuiz1"></div>
                </div>
            </div>

            <!-- è©æ€§è¾¨æ -->
            <div class="tab-content" id="grammarTab2">
                <div class="writing-exercise">
                    <h4>ğŸ“– è©æ€§è¾¨æ</h4>
                    <div class="grammar-explanation">
                        <strong>å¸¸è¦‹è©æ€§è½‰æ›ï¼š</strong><br>
                        â€¢ grow (å‹•è©) â†’ growth (åè©) â†’ growing (å½¢å®¹è©/ç¾åœ¨åˆ†è©)<br>
                        â€¢ success (åè©) â†’ successful (å½¢å®¹è©) â†’ successfully (å‰¯è©)<br>
                        â€¢ commit (å‹•è©) â†’ commitment (åè©) â†’ committed (å½¢å®¹è©)<br><br>
                        ä¾‹å¥ï¼š<br>
                        â€¢ The <strong>growth</strong> of the company has increased. (åè©ä½œä¸»èª)<br>
                        â€¢ The project was <strong>successfully</strong> completed. (å‰¯è©ä¿®é£¾å‹•è©)
                    </div>
                    <div id="grammarQuiz2"></div>
                </div>
            </div>

            <!-- ä¸»è©å‹•è©ä¸€è‡´ -->
            <div class="tab-content" id="grammarTab3">
                <div class="writing-exercise">
                    <h4>ğŸ“– ä¸»è©å‹•è©ä¸€è‡´</h4>
                    <div class="grammar-explanation">
                        <strong>ä¸€è‡´è¦å‰‡ï¼š</strong><br>
                        â€¢ é›†é«”åè© (team, group) ç”¨å–®æ•¸å‹•è©<br>
                        â€¢ <strong>neither...nor</strong> èˆ‡æœ€è¿‘çš„åè©ä¸€è‡´<br>
                        â€¢ <strong>the number of</strong> + è¤‡æ•¸åè©ç”¨å–®æ•¸å‹•è©<br>
                        â€¢ <strong>each of</strong> + è¤‡æ•¸åè©ç”¨å–®æ•¸å‹•è©<br><br>
                        ä¾‹å¥ï¼š<br>
                        â€¢ The team <strong>is</strong> working on the new strategy.<br>
                        â€¢ The number of applicants <strong>has</strong> exceeded expectations.
                    </div>
                    <div id="grammarQuiz3"></div>
                </div>
            </div>

            <!-- è™›æ“¬èªæ°£é€²éš -->
            <div class="tab-content" id="grammarTab4">
                <div class="writing-exercise">
                    <h4>ğŸ“– è™›æ“¬èªæ°£é€²éš</h4>
                    <div class="grammar-explanation">
                        <strong>è™›æ“¬èªæ°£åˆ†é¡ï¼š</strong><br>
                        â€¢ <strong>ç¬¬ä¸€é¡ï¼š</strong> If + Present, will + V (çœŸå¯¦æ¢ä»¶)<br>
                        â€¢ <strong>ç¬¬äºŒé¡ï¼š</strong> If + Past, would + V (å‡è¨­ç¾åœ¨)<br>
                        â€¢ <strong>ç¬¬ä¸‰é¡ï¼š</strong> If + Past Perfect, would have + V (å‡è¨­éå»)<br><br>
                        ä¾‹å¥ï¼š<br>
                        â€¢ If you study hard, you <strong>will</strong> pass.<br>
                        â€¢ If you studied hard, you <strong>would</strong> pass.<br>
                        â€¢ If you had studied hard, you <strong>would have</strong> passed.
                    </div>
                    <div id="grammarQuiz4"></div>
                </div>
            </div>
            </div>
        </div>

        <!-- å¯«ä½œç·´ç¿’æ ¸å¿ƒ -->
        <div class="section">
            <h2>âœï¸ å¯«ä½œç·´ç¿’å·¥ä½œå€</h2>
            
            <div class="tabs" id="writingTabs">
                <button class="tab active" onclick="switchWritingTab(0)">ç´šåˆ¥1ï¼šå¥å­çµ„åˆ</button>
                <button class="tab" onclick="switchWritingTab(1)">ç´šåˆ¥2ï¼šæ®µè½å¯«ä½œ</button>
                <button class="tab" onclick="switchWritingTab(2)">ç´šåˆ¥3ï¼šçŸ­æ–‡å‰µä½œ</button>
            </div>

            <div id="writingContent">
            <!-- ç´šåˆ¥1 -->
            <div class="tab-content active" id="writingTab0">
                <div class="writing-exercise">
                    <h4>ğŸ“ å¥å­çµ„åˆç·´ç¿’</h4>
                    <p style="color: var(--text-light); font-size: 14px; margin-bottom: 10px;">å°‡å…©å€‹ç°¡å–®å¥å­ç”¨é€£æ¥è©çµ„åˆæˆè¤‡é›œå¥</p>
                    
                    <div id="exercise1" style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <p><strong>é¡Œç›®ï¼š</strong> <span id="ex1Question"></span></p>
                        <p style="margin-top: 10px;"><strong>æç¤ºï¼š</strong> <span id="ex1Hint" style="color: var(--primary);"></span></p>
                    </div>

                    <textarea id="answer1" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„ç­”æ¡ˆ..."></textarea>
                    
                    <button class="btn" onclick="checkLevel1()">æäº¤æª¢æŸ¥</button>
                    <div id="feedback1"></div>

                    <div class="tips">
                        ğŸ’¡ æç¤ºï¼šä½¿ç”¨ because, although, when, if, unless ç­‰é€£æ¥è©
                    </div>
                </div>
            </div>

            <!-- ç´šåˆ¥2 -->
            <div class="tab-content" id="writingTab1">
                <div class="writing-exercise">
                    <h4>ğŸ“ æ®µè½å¯«ä½œç·´ç¿’</h4>
                    <p style="color: var(--text-light); font-size: 14px; margin-bottom: 10px;">æ ¹æ“šé—œéµè©å¯«å‡ºä¸€å€‹3-5å¥çš„æ®µè½</p>
                    
                    <div id="exercise2" style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <p><strong>ä¸»é¡Œï¼š</strong> <span id="ex2Topic"></span></p>
                        <p style="margin-top: 10px;"><strong>é—œéµè©ï¼š</strong> <span id="ex2Keywords" style="color: var(--primary);"></span></p>
                    </div>

                    <textarea id="answer2" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„ç­”æ¡ˆ..."></textarea>
                    
                    <button class="btn" onclick="checkLevel2()">æäº¤æª¢æŸ¥</button>
                    <div id="feedback2"></div>

                    <div class="tips">
                        ğŸ’¡ æç¤ºï¼šæ¯å€‹æ®µè½æ‡‰è©²æœ‰ä¸»é¡Œå¥å’Œæ”¯æŒå¥ã€‚ç¢ºä¿ä½¿ç”¨å¤šæ¨£çš„å¥å­çµæ§‹ã€‚
                    </div>
                </div>
            </div>

            <!-- ç´šåˆ¥3 -->
            <div class="tab-content" id="writingTab2">
                <div class="writing-exercise">
                    <h4>ğŸ“ çŸ­æ–‡å‰µä½œç·´ç¿’</h4>
                    <p style="color: var(--text-light); font-size: 14px; margin-bottom: 10px;">æ ¹æ“šä¸»é¡Œå¯«å‡ºä¸€ç¯‡150-200å­—çš„çŸ­æ–‡</p>
                    
                    <div id="exercise3" style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <p><strong>å¯«ä½œä¸»é¡Œï¼š</strong> <span id="ex3Topic"></span></p>
                    </div>

                    <textarea id="answer3" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„ç­”æ¡ˆ..."></textarea>
                    <div style="font-size: 13px; color: var(--text-light); margin-bottom: 10px;">å­—æ•¸ï¼š<span id="wordCounter">0</span>/150-200</div>
                    
                    <button class="btn" onclick="checkLevel3()">æäº¤æª¢æŸ¥</button>
                    <div id="feedback3"></div>

                    <div class="tips">
                        ğŸ’¡ æç¤ºï¼šåŒ…å«å¼•å…¥ã€ä¸»é«”å’Œçµè«–ã€‚ä½¿ç”¨éæ¸¡è©(however, furthermore, in conclusion)å¢åŠ æ–‡ç« é€£è²«æ€§ã€‚
                    </div>
                </div>
            </div>
            </div>
        </div>

        <!-- è©å½™å­¸ç¿’ -->
        <div class="section">
            <h2>ğŸ“š B2 é€²éšè©å½™å­¸ç¿’ (60å¤©ç„¡é‡è¤‡)</h2>
            <div id="vocabularyList"></div>
        </div>

        <!-- é€²åº¦è¿½è¹¤ -->
        <div class="section">
            <h2>ğŸ“Š å­¸ç¿’é€²åº¦</h2>
            <div class="progress-section">
                <div class="progress-item">
                    <div class="progress-label">
                        <span>è½åŠ›ç†è§£ (Listening)</span>
                        <span id="listeningPct">65%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 65%; background: #2196F3;"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>å£èªªæµæš¢ (Speaking)</span>
                        <span id="speakingPct">60%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 60%; background: #4CAF50;"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>é–±è®€ç†è§£ (Reading)</span>
                        <span id="readingPct">70%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 70%; background: #FF9800;"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>å¯«ä½œèƒ½åŠ› (Writing)</span>
                        <span id="writingPct">55%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 55%; background: #F44336;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å­¸ç¿’æ•¸æ“š
        const scheduleData = [
            { day: 'ğŸŒ™ æ˜ŸæœŸä¸€', theme: 'å•†å‹™è‹±æ–‡', focus: 'Emailå¯«ä½œã€æœƒè­°ç”¨èª', keywords: 'proposal, agenda, deadline' },
            { day: 'ğŸŒ™ æ˜ŸæœŸäºŒ', theme: 'æ—¥å¸¸ç”Ÿæ´»', focus: 'æ—¥å¸¸å°è©±ã€è³¼ç‰©ã€é¤å»³', keywords: 'I\'d like, could you, absolutely' },
            { day: 'ğŸ“– æ˜ŸæœŸä¸‰', theme: 'é–±è®€æ—¥', focus: 'æ–°èæ–‡ç« ã€éƒ¨è½æ ¼', keywords: 'è¤‡é›œå¥å­ã€é•·ç¯‡æ–‡ç« ' },
            { day: 'âœï¸ æ˜ŸæœŸå››', theme: 'å¯«ä½œæ—¥', focus: 'çŸ­æ–‡ã€æ®µè½ã€è«–æ–‡', keywords: 'æ®µè½çµæ§‹ã€éŠœæ¥è©' },
            { day: 'ğŸ¤ æ˜ŸæœŸäº”', theme: 'å£èªªç·´ç¿’', focus: 'æ¼”è¬›ã€è¨è«–ã€è¾¯è«–', keywords: 'argue, emphasize, persuade' },
            { day: 'ğŸ¯ æ˜ŸæœŸå…­', theme: 'ç¶œåˆè¤‡ç¿’', focus: 'æ··åˆæŠ€èƒ½ç·´ç¿’', keywords: 'è¤‡ç¿’æ‰€æœ‰æŠ€èƒ½' },
            { day: 'ğŸ“Š æ˜ŸæœŸæ—¥', theme: 'è©•ä¼°æ¸¬è©¦', focus: 'é€±æ¸¬é©—ã€é€²åº¦è©•ä¼°', keywords: 'é€²åº¦æª¢æ¸¬' }
        ];

        // æ“´å……å¯«ä½œç·´ç¿’é¡Œåº« - 60å¤©ç„¡é‡è¤‡
        const writingExercisesBank = {
            level1: [
                { question: 'Combine: "She finished her homework. She went to play." Answer should use a conjunction.', hint: 'Use "after" or "before"' },
                { question: 'Combine: "He studied hard. He passed the exam." Answer should use a conjunction.', hint: 'Use "so" or "because"' },
                { question: 'Combine: "The weather was bad. We went outside anyway." Answer should use a conjunction.', hint: 'Use "although" or "even though"' },
                { question: 'Combine: "I finished my work. I went home." Answer should use a conjunction.', hint: 'Use "after" or "when"' },
                { question: 'Combine: "She was tired. She continued studying." Answer should use a conjunction.', hint: 'Use "though" or "despite"' },
                { question: 'Combine: "He won the competition. He practiced every day." Answer should use a conjunction.', hint: 'Use "because" or "since"' },
                { question: 'Combine: "The meeting ended. Everyone went to lunch." Answer should use a conjunction.', hint: 'Use "after" or "once"' },
                { question: 'Combine: "She was sick. She still attended the class." Answer should use a conjunction.', hint: 'Use "although" or "despite"' },
                { question: 'Combine: "He arrives early. He always gets a good seat." Answer should use a conjunction.', hint: 'Use "because" or "so"' },
                { question: 'Combine: "The project is difficult. The team is determined." Answer should use a conjunction.', hint: 'Use "although" or "but"' },
                { question: 'Combine: "You study regularly. You will improve." Answer should use a conjunction.', hint: 'Use "if" or "as long as"' },
                { question: 'Combine: "The presentation was clear. Everyone understood." Answer should use a conjunction.', hint: 'Use "so" or "therefore"' },
                { question: 'Combine: "It was raining. They played football." Answer should use a conjunction.', hint: 'Use "although" or "despite"' },
                { question: 'Combine: "She spoke softly. Everyone listened carefully." Answer should use a conjunction.', hint: 'Use "because" or "so"' },
                { question: 'Combine: "The restaurant is expensive. The food is excellent." Answer should use a conjunction.', hint: 'Use "although" or "but"' },
                { question: 'Combine: "He forgot his key. He had to wait outside." Answer should use a conjunction.', hint: 'Use "because" or "since"' },
                { question: 'Combine: "She finished first. She was the fastest runner." Answer should use a conjunction.', hint: 'Use "because" or "as"' },
                { question: 'Combine: "The movie was long. I enjoyed it." Answer should use a conjunction.', hint: 'Use "although" or "but"' },
                { question: 'Combine: "He left early. He had an appointment." Answer should use a conjunction.', hint: 'Use "because" or "since"' },
                { question: 'Combine: "The weather improved. We went for a walk." Answer should use a conjunction.', hint: 'Use "so" or "therefore"' }
            ],
            level2: [
                { topic: 'My favorite hobby', keywords: 'enjoy, practice, improve, passion' },
                { topic: 'A memorable travel experience', keywords: 'memorable, experience, learned, cultural' },
                { topic: 'The role of technology in education', keywords: 'technology, learning, improve, access' },
                { topic: 'How to manage time effectively', keywords: 'schedule, priority, focus, achieve' },
                { topic: 'The importance of friendship', keywords: 'support, trust, loyal, meaningful' },
                { topic: 'Environmental protection initiatives', keywords: 'protect, recycle, sustainable, future' },
                { topic: 'Healthy lifestyle choices', keywords: 'exercise, nutrition, balance, wellness' },
                { topic: 'Digital communication benefits', keywords: 'connect, convenient, instant, global' },
                { topic: 'Cultural diversity in my community', keywords: 'diverse, tradition, celebrate, respect' },
                { topic: 'Career development strategies', keywords: 'skills, growth, motivation, success' },
                { topic: 'The power of reading', keywords: 'imagination, knowledge, escape, expand' },
                { topic: 'Challenges of modern parenting', keywords: 'responsibility, guidance, patience, nurture' },
                { topic: 'Benefits of lifelong learning', keywords: 'curiosity, adaptation, knowledge, growth' },
                { topic: 'Social media impact on society', keywords: 'connection, influence, awareness, concern' },
                { topic: 'Importance of mental health', keywords: 'awareness, support, stress, wellbeing' },
                { topic: 'Economic development in developing nations', keywords: 'growth, opportunity, investment, progress' },
                { topic: 'The art of effective communication', keywords: 'clarity, empathy, understanding, connection' },
                { topic: 'Sustainable fashion and clothing', keywords: 'ethical, environment, quality, consciousness' },
                { topic: 'The role of sports in society', keywords: 'teamwork, discipline, achievement, health' },
                { topic: 'Urban vs rural living experiences', keywords: 'lifestyle, convenience, community, nature' }
            ],
            level3: [
                { topic: 'The importance of learning English in the digital age' },
                { topic: 'How to balance work and personal life' },
                { topic: 'The impact of social media on society' },
                { topic: 'Why continuous learning is essential for success' },
                { topic: 'Environmental protection and individual responsibility' },
                { topic: 'The role of artificial intelligence in education' },
                { topic: 'How globalization has changed our world' },
                { topic: 'The importance of cultural exchange and understanding' },
                { topic: 'Technology and its effects on human relationships' },
                { topic: 'Education equality and access in developing countries' },
                { topic: 'The future of remote work and its implications' },
                { topic: 'Climate change and personal lifestyle choices' },
                { topic: 'Mental health awareness in educational institutions' },
                { topic: 'The role of government in public health' },
                { topic: 'Economic inequality and social justice' },
                { topic: 'Ethical considerations in genetic engineering' },
                { topic: 'The influence of traditional media vs social media' },
                { topic: 'Sustainable tourism and cultural preservation' },
                { topic: 'Digital literacy in modern education systems' },
                { topic: 'Immigration and its effects on host countries' }
            ]
        };

        // æ“´å……è©å½™åº« - 60å¤©ç„¡é‡è¤‡
        const vocabularyData = [
            { word: 'proficiency', pronunciation: '/prÉ™ËˆfÉªÊƒÉ™nsi/', meaning: 'ç†Ÿç·´åº¦ã€ç²¾é€š', example: 'Language proficiency is essential for international business.' },
            { word: 'coherent', pronunciation: '/koÊŠËˆhÉªrÉ™nt/', meaning: 'é€£è²«çš„ã€æ¸…æ™°çš„', example: 'Your essay should have a coherent structure.' },
            { word: 'elaborate', pronunciation: '/ÉªËˆlÃ¦bÉ™rÉ™t/', meaning: 'è©³ç´°èªªæ˜ã€è©³ç´°çš„', example: 'Can you elaborate on your previous point?' },
            { word: 'concise', pronunciation: '/kÉ™nËˆsaÉªs/', meaning: 'ç°¡æ˜çš„ã€ç°¡æ½”çš„', example: 'Write a concise summary of the article.' },
            { word: 'nuance', pronunciation: '/ËˆnuËÉ‘Ëns/', meaning: 'ç´°å¾®å·®åˆ¥ã€ç´°ç¯€', example: 'B2 learners should understand the nuances of English grammar.' },
            { word: 'pragmatic', pronunciation: '/prÃ¦É¡ËˆmÃ¦tÉªk/', meaning: 'å¯¦ç”¨ä¸»ç¾©çš„ã€å¯¦éš›çš„', example: 'Take a pragmatic approach to language learning.' },
            { word: 'meticulous', pronunciation: '/mÉ™ËˆtÉªkjÉ™lÉ™s/', meaning: 'ä¸€çµ²ä¸èŒçš„ã€ç´°å¿ƒçš„', example: 'The researcher was meticulous in collecting data.' },
            { word: 'ambiguous', pronunciation: '/Ã¦mËˆbÉªÉ¡juÉ™s/', meaning: 'æ›–æ˜§çš„ã€æ¨¡ç¨œå…©å¯çš„', example: 'The instruction was ambiguous and caused confusion.' },
            { word: 'resilient', pronunciation: '/rÉªËˆzÉªljÉ™nt/', meaning: 'æœ‰æ¢å¾©åŠ›çš„ã€å …å¼·çš„', example: 'Resilient people can bounce back from setbacks.' },
            { word: 'aesthetic', pronunciation: '/esËˆÎ¸etÉªk/', meaning: 'ç¾å­¸çš„ã€å¯©ç¾çš„', example: 'The aesthetic design of the building is striking.' },
            { word: 'ubiquitous', pronunciation: '/juËËˆbÉªkwÉªtÉ™s/', meaning: 'ç„¡è™•ä¸åœ¨çš„', example: 'Smartphones are ubiquitous in modern society.' },
            { word: 'tangible', pronunciation: '/ËˆtÃ¦ndÊ’É™bl/', meaning: 'æœ‰å½¢çš„ã€å…·é«”çš„', example: 'We need tangible results from this project.' },
            { word: 'ephemeral', pronunciation: '/ÉªËˆfÉ›mÉ™rÉ™l/', meaning: 'çŸ­æš«çš„ã€è½‰ç¬å³é€çš„', example: 'The beauty of cherry blossoms is ephemeral.' },
            { word: 'synergy', pronunciation: '/ËˆsÉªnÉ™rdÊ’i/', meaning: 'å”åŒä½œç”¨', example: 'The synergy between team members improved productivity.' },
            { word: 'articulate', pronunciation: '/É‘rËˆtÉªkjÉ™lÉ™t/', meaning: 'æ¸…æ¥šè¡¨é”çš„ã€å–„æ–¼è¡¨é”çš„', example: 'The speaker was articulate and persuasive.' },
            { word: 'diligent', pronunciation: '/ËˆdÉªlÉªdÊ’É™nt/', meaning: 'å‹¤å‹‰çš„ã€èªçœŸçš„', example: 'Diligent study leads to academic success.' },
            { word: 'esoteric', pronunciation: '/ËŒesÉ™ËˆterÉªk/', meaning: 'æ·±å¥§çš„ã€åªæœ‰å°‘æ•¸äººæ‡‚çš„', example: 'The novel contains esoteric references.' },
            { word: 'perspicacious', pronunciation: '/ËŒpÉœËrspÉªËˆkeÉªÊƒÉ™s/', meaning: 'æ´å¯ŸåŠ›å¼·çš„ã€æ•éŠ³çš„', example: 'His perspicacious analysis revealed hidden patterns.' },
            { word: 'gregarious', pronunciation: '/É¡rÉªËˆÉ¡É›riÉ™s/', meaning: 'ç¾¤å±…çš„ã€å¥½äº¤éš›çš„', example: 'Humans are gregarious creatures who enjoy social interaction.' },
            { word: 'capricious', pronunciation: '/kÉ™ËˆprÉªÊƒÉ™s/', meaning: 'åè¦†ç„¡å¸¸çš„ã€ä»»æ„çš„', example: 'The capricious weather made planning difficult.' },
            { word: 'cantankerous', pronunciation: '/kÃ¦nËˆtÃ¦Å‹kÉ™rÉ™s/', meaning: 'è„¾æ°£å£çš„ã€æ˜“æ€’çš„', example: 'The cantankerous old man complained constantly.' },
            { word: 'pellucid', pronunciation: '/ËˆpÉ›lÊŒsÉªd/', meaning: 'æ¸…æ¾ˆçš„ã€æ˜“ç†è§£çš„', example: 'The pellucid water revealed the ocean floor.' },
            { word: 'obfuscate', pronunciation: '/ËˆÉ‘bfÉ™skeÉªt/', meaning: 'ä½¿å«ç³Šä¸æ¸…ã€æ··æ·†', example: 'The report tried to obfuscate the real issues.' },
            { word: 'juxtapose', pronunciation: '/ËˆdÊ’ÊŒkstÉ™poÊŠz/', meaning: 'ä¸¦åˆ—ã€å°ç…§', example: 'The artist juxtaposed light and dark colors.' },
            { word: 'lambent', pronunciation: '/ËˆlÃ¦mbÉ™nt/', meaning: 'æŸ”å’Œç™¼å…‰çš„', example: 'The lambent glow of the sunset was beautiful.' },
            { word: 'sanguine', pronunciation: '/ËˆsÃ¦Å‹É¡wÉªn/', meaning: 'æ¨‚è§€çš„ã€ç©æ¥µçš„', example: 'He maintained a sanguine outlook despite difficulties.' },
            { word: 'bellicose', pronunciation: '/ËˆbelÉªkoÊŠs/', meaning: 'å¥½æˆ°çš„ã€å¥½é¬¥çš„', example: 'His bellicose remarks caused international tension.' },
            { word: 'corpulent', pronunciation: '/ËˆkÉ”rpjÉ™lÉ™nt/', meaning: 'è‚¥èƒ–çš„ã€è‡ƒè…«çš„', example: 'The corpulent man struggled to climb the stairs.' },
            { word: 'dulcet', pronunciation: '/ËˆdÊŒlsÉªt/', meaning: 'æ‚…è€³çš„ã€ç”œèœœçš„', example: 'The dulcet tones of the violin enchanted the audience.' },
            { word: 'effete', pronunciation: '/ÉªËˆfit/', meaning: 'è¡°å¼±çš„ã€ç„¡ç”Ÿç”¢åŠ›çš„', example: 'The effete empire could no longer defend itself.' },
            { word: 'felicitous', pronunciation: '/fÉªËˆlÉªsÉªtÉ™s/', meaning: 'æ°ç•¶çš„ã€ä»¤äººé«˜èˆˆçš„', example: 'His felicitous remark broke the tension.' },
            { word: 'halcyon', pronunciation: '/ËˆhÃ¦lsiÉ™n/', meaning: 'å¹³éœçš„ã€é»ƒé‡‘æ™‚ä»£çš„', example: 'They reminisced about halcyon days of their youth.' },
            { word: 'insipid', pronunciation: '/ÉªnËˆsÉªpÉªd/', meaning: 'ä¹å‘³çš„ã€ç„¡èŠçš„', example: 'The insipid plot failed to interest audiences.' },
            { word: 'loquacious', pronunciation: '/loÊŠËˆkweÉªÊƒÉ™s/', meaning: 'å¤šè¨€çš„ã€è©±å¤šçš„', example: 'The loquacious guest talked throughout dinner.' },
            { word: 'moribund', pronunciation: '/ËˆmÉ”rÉªbÊŒnd/', meaning: 'å‚æ­»çš„ã€è¡°å¾®çš„', example: 'The moribund industry needed reform.' },
            { word: 'nefarious', pronunciation: '/nÉªËˆfÉ›riÉ™s/', meaning: 'é‚ªæƒ¡çš„ã€ç½ªæƒ¡çš„', example: 'He was accused of nefarious activities.' },
            { word: 'obsequious', pronunciation: '/É™bËˆsikwiÉ™s/', meaning: 'éä»½æ®·å‹¤çš„ã€å¥‰æ‰¿çš„', example: 'The obsequious servant bowed repeatedly.' },
            { word: 'parsimonious', pronunciation: '/ËŒpÉ‘rsÉªËˆmoÊŠniÉ™s/', meaning: 'åå—‡çš„ã€éåº¦ç¯€å„‰çš„', example: 'His parsimonious nature prevented him from enjoying life.' },
            { word: 'querulous', pronunciation: '/ËˆkwÉ›rÉ™lÉ™s/', meaning: 'æ„›ç™¼ç‰¢é¨·çš„ã€ä¸æ»¿çš„', example: 'The querulous patient complained about everything.' },
            { word: 'recalcitrant', pronunciation: '/rÉªËˆkÃ¦lsÉªtrÉ™nt/', meaning: 'åæŠ—çš„ã€é ‘å›ºçš„', example: 'The recalcitrant student refused to obey rules.' },
            { word: 'sagacious', pronunciation: '/sÉ™ËˆÉ¡eÉªÊƒÉ™s/', meaning: 'è°æ…§çš„ã€æœ‰çœ¼å…‰çš„', example: 'The sagacious leader made wise decisions.' },
            { word: 'sesquipedalian', pronunciation: '/ËŒseskwÉªpÉªËˆdeÉªliÉ™n/', meaning: 'å†—é•·çš„ã€ç”¨è©è¯éº—çš„', example: 'His sesquipedalian vocabulary impressed nobody.' },
            { word: 'turbid', pronunciation: '/ËˆtÉœrbÉªd/', meaning: 'æ¸¾æ¿çš„ã€æ˜æš—çš„', example: 'The turbid water made it difficult to see below.' },
            { word: 'uxorial', pronunciation: '/ÊŒkËˆsÉ”riÉ™l/', meaning: 'å°å¦»å­éåˆ†æººæ„›çš„', example: 'His uxorial devotion was well-known.' },
            { word: 'vituperative', pronunciation: '/vaÉªËˆtjupÉ™rÉ™tÉªv/', meaning: 'è¬¾ç½µçš„ã€è¾±ç½µçš„', example: 'The vituperative speech caused outrage.' },
            { word: 'wistful', pronunciation: '/ËˆwÉªstfÉ™l/', meaning: 'æ¸´æœ›çš„ã€æ€å¿µçš„', example: 'She had a wistful expression when remembering childhood.' },
            { word: 'xerophilous', pronunciation: '/zÉªËˆrÉ‘fÉªlÉ™s/', meaning: 'å–œä¹¾æ—±ç’°å¢ƒçš„', example: 'Xerophilous plants thrive in deserts.' },
            { word: 'yeasty', pronunciation: '/ËˆjÉ›sti/', meaning: 'å……æ»¿æ´»åŠ›çš„ã€ç™¼é…µçš„', example: 'The yeasty dough was ready for baking.' },
            { word: 'zealous', pronunciation: '/ËˆzÉ›lÉ™s/', meaning: 'ç†±æƒ…çš„ã€ç‹‚ç†±çš„', example: 'The zealous activists fought for their cause.' },
            { word: 'acerbic', pronunciation: '/É™ËˆsÉœrbÉªk/', meaning: 'å°–åˆ»çš„ã€é…¸æ¾€çš„', example: 'His acerbic wit made people laugh nervously.' },
            { word: 'bucolic', pronunciation: '/bjuËËˆkÉ‘lÉªk/', meaning: 'ç”°åœ’çš„ã€è¾²æ‘çš„', example: 'The bucolic landscape was peaceful and serene.' },
            { word: 'cacophonous', pronunciation: '/kÉ™ËˆkÉ‘fÉ™nÉ™s/', meaning: 'åˆºè€³çš„ã€ä¸å’Œè«§çš„', example: 'The cacophonous sounds of traffic disturbed sleep.' },
            { word: 'desiccate', pronunciation: '/ËˆdesÉªkeÉªt/', meaning: 'ä½¿ä¹¾ç‡¥ã€ä¹¾æ¯', example: 'The desert heat desiccated the plants.' },
            { word: 'ebullient', pronunciation: '/ÉªËˆbÊŒliÉ™nt/', meaning: 'ç†±æƒ…æ´‹æº¢çš„ã€æ­¡é¨°çš„', example: 'Her ebullient personality brightened the room.' }
            ];

        // æ ¹æ“šæ—¥æœŸé¸æ“‡ä»Šæ—¥ç·´ç¿’
        function getTodayExercise(level) {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            const bank = writingExercisesBank[`level${level}`];
            return bank[dayOfYear % bank.length];
        }

        function getStorageKey(key) {
            return currentUser ? `${currentUser}_${key}` : key;
        }

        // æ¯æ—¥è‡ªå‹•é‡ç½®ç·´ç¿’ä¸¦æ›´æ–°å…§å®¹
        function performDailyReset() {
            const today = new Date().toDateString();
            const lastReset = localStorage.getItem(getStorageKey('lastPracticeReset'));
            
            if (lastReset !== today) {
                localStorage.setItem(getStorageKey('lastPracticeReset'), today);
                updateDailyContent();
                document.getElementById('answer1').value = '';
                document.getElementById('answer2').value = '';
                document.getElementById('answer3').value = '';
            }
        }

        // æ›´æ–°æ¯æ—¥ç·´ç¿’å…§å®¹
        function updateDailyContent() {
            const level1Ex = getTodayExercise(1);
            const level2Ex = getTodayExercise(2);
            const level3Ex = getTodayExercise(3);
            
            document.getElementById('ex1Question').textContent = level1Ex.question;
            document.getElementById('ex1Hint').textContent = level1Ex.hint;
            
            document.getElementById('ex2Topic').textContent = level2Ex.topic;
            document.getElementById('ex2Keywords').textContent = level2Ex.keywords;
            
            document.getElementById('ex3Topic').textContent = level3Ex.topic;
        }

        function loadSchedule() {
            const container = document.getElementById('scheduleContent');
            container.innerHTML = scheduleData.map(item => `
                <div class="schedule-day">
                    <h4>${item.day}: ${item.theme}</h4>
                    <p><strong>å­¸ç¿’é‡é»ï¼š</strong> ${item.focus}</p>
                    <p><strong>æ ¸å¿ƒè©å½™ï¼š</strong> ${item.keywords}</p>
                </div>
            `).join('');
        }

        function loadVocabulary() {
            const container = document.getElementById('vocabularyList');
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            
            // æ¯å¤©é¡¯ç¤º6å€‹è©å½™ï¼ˆ60å¤©å…§ç„¡é‡è¤‡ï¼‰
            const startIndex = (dayOfYear * 6) % vocabularyData.length;
            const todayVocab = [];
            for (let i = 0; i < 6; i++) {
                todayVocab.push(vocabularyData[(startIndex + i) % vocabularyData.length]);
            }
            
            container.innerHTML = todayVocab.map((item, index) => `
                <div class="vocabulary-card">
                    <div class="word">
                        ${item.word}
                        <button class="play-btn" onclick="pronounceWord('${item.word}')" title="æ’­æ”¾ç™¼éŸ³">ğŸ”Š</button>
                    </div>
                    <div class="pronunciation">${item.pronunciation}</div>
                    <div class="meaning">ğŸ’¡ ${item.meaning}</div>
                    <div class="example">ä¾‹å¥ï¼š${item.example}</div>
                </div>
            `).join('');
        }

        function pronounceWord(word) {
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US';
            utterance.rate = 0.9;
            utterance.pitch = 1;
            
            const btn = event.target;
            btn.classList.add('playing');
            
            utterance.onend = () => {
                btn.classList.remove('playing');
            };
            
            speechSynthesis.cancel();
            speechSynthesis.speak(utterance);
        }

        function updateStats() {
            const saved = localStorage.getItem(getStorageKey('englishStats'));
            if (saved) {
                const stats = JSON.parse(saved);
                document.getElementById('dayCount').textContent = stats.dayCount || 0;
                document.getElementById('wordCount').textContent = stats.wordCount || 0;
                document.getElementById('writingCount').textContent = stats.writingCount || 0;
                document.getElementById('streak').textContent = stats.streak || 0;
            } else {
                document.getElementById('dayCount').textContent = 0;
                document.getElementById('wordCount').textContent = 0;
                document.getElementById('writingCount').textContent = 0;
                document.getElementById('streak').textContent = 0;
            }
        }

        function incrementStats(key) {
            let stats = {};
            const saved = localStorage.getItem(getStorageKey('englishStats'));
            
            if (saved) {
                stats = JSON.parse(saved);
            }
            
            stats[key] = (stats[key] || 0) + 1;
            localStorage.setItem(getStorageKey('englishStats'), JSON.stringify(stats));
            updateStats();
        }

        // æ“´å……æ–‡æ³•æ•¸æ“š - 60å¤©ç„¡é‡è¤‡
        const grammarData = [
            {
                topic: 'ç¾åœ¨å®Œæˆå¼ vs éå»å®Œæˆå¼',
                questions: [
                    { question: 'I _____ in this city for 10 years.', options: ['lived', 'have lived', 'had lived', 'was living'], correct: 1, explanation: 'ç¾åœ¨å®Œæˆå¼è¡¨ç¤ºå¾éå»åˆ°ç¾åœ¨çš„æŒçºŒç‹€æ…‹ã€‚' },
                    { question: 'Before he arrived, they _____ the meeting.', options: ['started', 'have started', 'had started', 'were starting'], correct: 2, explanation: 'éå»å®Œæˆå¼è¡¨ç¤ºåœ¨å¦ä¸€å€‹éå»å‹•ä½œä¹‹å‰ç™¼ç”Ÿçš„äº‹ã€‚' },
                    { question: 'She _____ three novels since she started writing.', options: ['writes', 'has written', 'had written', 'wrote'], correct: 1, explanation: 'ç¾åœ¨å®Œæˆå¼è¡¨ç¤ºå·²å®Œæˆçš„å‹•ä½œã€‚' },
                    { question: 'By the time we arrived, the movie _____ started.', options: ['has', 'have', 'had', 'was'], correct: 2, explanation: 'éå»å®Œæˆå¼è¡¨ç¤ºå…©å€‹éå»å‹•ä½œçš„æ™‚é–“é †åºã€‚' },
                    { question: 'I _____ that book three times already.', options: ['read', 'have read', 'had read', 'am reading'], correct: 1, explanation: 'å·²ç¶“...è¡¨ç¤ºä½¿ç”¨ç¾åœ¨å®Œæˆå¼ã€‚' },
                    { question: 'They _____ the project before the deadline.', options: ['complete', 'have completed', 'had completed', 'completed'], correct: 2, explanation: 'éå»å®Œæˆå¼è¡¨ç¤ºæ›´æ—©çš„éå»äº‹ä»¶ã€‚' }
                ]
            },
            {
                topic: 'ä»‹ç³»è©æ‡‰ç”¨',
                questions: [
                    { question: 'The manager is responsible _____ the entire project.', options: ['in', 'for', 'at', 'on'], correct: 1, explanation: 'responsible forè¡¨ç¤ºè² è²¬ã€‚' },
                    { question: 'We are looking _____ to your arrival next week.', options: ['at', 'forward', 'for', 'after'], correct: 1, explanation: 'look forward toè¡¨ç¤ºæœŸå¾…ã€‚' },
                    { question: 'The training will be held _____ June 15th at 2 PM.', options: ['at', 'on', 'in', 'by'], correct: 1, explanation: 'å…·é«”æ—¥æœŸå‰ç”¨onã€‚' },
                    { question: '_____ the budget constraints, the company still invested.', options: ['Although', 'Despite', 'Because', 'Due to'], correct: 1, explanation: 'Despiteå¾Œæ¥åè©ç‰‡èªã€‚' },
                    { question: 'We succeeded _____ great effort and determination.', options: ['by', 'with', 'through', 'in'], correct: 2, explanation: 'throughè¡¨ç¤ºè—‰ç”±ã€‚' },
                    { question: 'She is interested _____ learning new languages.', options: ['in', 'on', 'at', 'for'], correct: 0, explanation: 'interested inè¡¨ç¤ºå°...æœ‰èˆˆè¶£ã€‚' }
                ]
            },
            {
                topic: 'è©æ€§è¾¨æ',
                questions: [
                    { question: 'The _____ of the company has increased significantly.', options: ['growth', 'grow', 'growing', 'grows'], correct: 0, explanation: 'å† è©Theå¾Œéœ€è¦åè©ã€‚' },
                    { question: 'The project was _____ completed before the deadline.', options: ['success', 'successfully', 'succeed', 'successful'], correct: 1, explanation: 'ä¿®é£¾å‹•è©éœ€è¦å‰¯è©ã€‚' },
                    { question: 'We received an _____ proposal from our partner.', options: ['impress', 'impressive', 'impressed', 'impression'], correct: 1, explanation: 'ä¿®é£¾åè©éœ€è¦å½¢å®¹è©ã€‚' },
                    { question: 'The employee\'s _____ to the job is commendable.', options: ['commit', 'commitment', 'committed', 'commits'], correct: 1, explanation: ''så¾Œéœ€è¦åè©ã€‚' },
                    { question: 'All participants must _____ to the code of conduct.', options: ['comply', 'compliance', 'compliant', 'complied'], correct: 0, explanation: 'åŠ©å‹•è©mustå¾Œç”¨å‹•è©åŸå½¢ã€‚' },
                    { question: 'The _____ team completed the task on time.', options: ['efficiency', 'efficient', 'efficiently', 'effect'], correct: 1, explanation: 'ä¿®é£¾åè©teaméœ€è¦å½¢å®¹è©ã€‚' }
                ]
            },
            {
                topic: 'ä¸»è©å‹•è©ä¸€è‡´',
                questions: [
                    { question: 'The team _____ working on the new strategy.', options: ['are', 'is', 'have', 'has been'], correct: 1, explanation: 'é›†é«”åè©teamç”¨å–®æ•¸ã€‚' },
                    { question: 'Neither the manager nor the employees _____ available.', options: ['is', 'are', 'was', 'be'], correct: 1, explanation: 'neither...norèˆ‡æœ€è¿‘ä¸»è©employeesä¸€è‡´ã€‚' },
                    { question: 'The number of applicants _____ exceeded expectations.', options: ['have', 'has', 'was', 'were'], correct: 1, explanation: 'the number ofç”¨å–®æ•¸ã€‚' },
                    { question: 'Each of the participants _____ received a certificate.', options: ['have', 'has', 'were', 'are'], correct: 1, explanation: 'eachç”¨å–®æ•¸ã€‚' },
                    { question: 'The committee _____ decided on the new policy.', options: ['have', 'has', 'are', 'were'], correct: 1, explanation: 'é›†é«”åè©committeeç”¨å–®æ•¸ã€‚' },
                    { question: 'A series of events _____ planned for the festival.', options: ['is', 'are', 'was', 'were'], correct: 0, explanation: 'a series ofç”¨å–®æ•¸ã€‚' }
                ]
            },
            {
                topic: 'è™›æ“¬èªæ°£é€²éš',
                questions: [
                    { question: 'If I _____ you, I would accept the offer.', options: ['was', 'were', 'am', 'had been'], correct: 1, explanation: 'è™›æ“¬èªæ°£ä¸­ä½¿ç”¨ wereï¼Œå³ä½¿ä¸»èªæ˜¯å–®æ•¸ã€‚' },
                    { question: 'If you _____ harder, you would have passed.', options: ['studied', 'had studied', 'study', 'would study'], correct: 1, explanation: 'ç¬¬ä¸‰é¡æ¢ä»¶å¥ç”¨éå»å®Œæˆå¼ã€‚' },
                    { question: 'If she _____ the job, she would be happier.', options: ['gets', 'got', 'will get', 'had got'], correct: 1, explanation: 'ç¬¬äºŒé¡æ¢ä»¶å¥ç”¨éå»å¼ã€‚' },
                    { question: 'If we _____ known earlier, we would have prepared better.', options: ['have', 'has', 'had', 'would have'], correct: 2, explanation: 'ç¬¬ä¸‰é¡æ¢ä»¶å¥ç”¨éå»å®Œæˆå¼ã€‚' },
                    { question: 'Unless you _____, you will fail the exam.', options: ['study', 'studied', 'studies', 'have studied'], correct: 0, explanation: 'Unlesså¾Œè·ŸçœŸå¯¦æ¢ä»¶ï¼Œç”¨ç¾åœ¨å¼ã€‚' },
                    { question: 'I wish he _____ more time to complete the project.', options: ['has', 'had', 'have', 'would have'], correct: 1, explanation: 'wishå¾Œç”¨è™›æ“¬éå»å¼ã€‚' }
                ]
            }
        ];

        // ç”¨æˆ¶ç®¡ç†è®Šæ•¸
        let currentUser = null;
        let allUsers = [];

        // åˆå§‹åŒ–ç”¨æˆ¶ç³»çµ±
        function initUserSystem() {
            const savedUsers = localStorage.getItem('allEnglishUsers');
            if (savedUsers) {
                allUsers = JSON.parse(savedUsers);
                const lastUser = localStorage.getItem('lastEnglishUser');
                if (lastUser && allUsers.includes(lastUser)) {
                    currentUser = lastUser;
                }
            }
            if (!currentUser && allUsers.length > 0) {
                currentUser = allUsers[0];
            }
            updateUserDisplay();
        }

        function updateUserDisplay() {
            document.getElementById('currentUserDisplay').textContent = currentUser ? `ğŸ‘¤ ${currentUser}` : 'ğŸ‘¤ éŠå®¢';
            if (currentUser) {
                localStorage.setItem('lastEnglishUser', currentUser);
            }
        }

        function openUserModal() {
            document.getElementById('userModal').classList.add('show');
            renderUserList();
        }

        function closeUserModal() {
            document.getElementById('userModal').classList.remove('show');
        }

        function renderUserList() {
            const userList = document.getElementById('userList');
            userList.innerHTML = allUsers.map(user => `
                <div class="user-item ${user === currentUser ? 'active' : ''}" onclick="switchUser('${user}')">
                    ğŸ‘¤ ${user}
                </div>
            `).join('');
        }

        function switchUser(userName) {
            currentUser = userName;
            updateUserDisplay();
            updateStats();
            loadVocabulary();
            updateDailyContent();
            loadGrammarQuizzes();
            closeUserModal();
        }

        function createNewUser() {
            const input = document.getElementById('newUserInput');
            const userName = input.value.trim();
            if (userName && !allUsers.includes(userName)) {
                allUsers.push(userName);
                localStorage.setItem('allEnglishUsers', JSON.stringify(allUsers));
                switchUser(userName);
                input.value = '';
            }
        }

        // æ–‡æ³•æ¸¬é©—åˆå§‹åŒ–
        function loadGrammarQuizzes() {
            grammarData.forEach((topic, index) => {
                const container = document.getElementById(`grammarQuiz${index}`);
                if (container) {
                    const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
                    const question = topic.questions[dayOfYear % topic.questions.length];
                    container.innerHTML = `
                        <div class="grammar-question">
                            <p style="margin-bottom: 12px;"><strong>é¡Œç›®ï¼š</strong> ${question.question}</p>
                            <div class="grammar-options" id="options${index}">
                                ${question.options.map((opt, i) => `
                                    <label class="option">
                                        <input type="radio" name="grammar${index}" value="${i}" onchange="checkGrammar(${index}, ${i}, ${question.correct}, '${question.explanation}')">
                                        ${opt}
                                    </label>
                                `).join('')}
                            </div>
                            <div id="grammarFeedback${index}"></div>
                        </div>
                    `;
                }
            });
        }

        function checkGrammar(quizIndex, selectedIndex, correctIndex, explanation) {
            const feedback = document.getElementById(`grammarFeedback${quizIndex}`);
            if (selectedIndex === correctIndex) {
                feedback.innerHTML = `<div class="feedback success">âœ… æ­£ç¢ºï¼${explanation}</div>`;
                incrementStats('grammarScore');
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ ${explanation}</div>`;
            }
        }

        // æ¯æ—¥æ‰“å¡ç³»çµ±
        function performDailyCheckIn() {
            const today = new Date().toDateString();
            const lastCheckIn = localStorage.getItem(getStorageKey('lastCheckIn'));
            
            if (lastCheckIn !== today) {
                localStorage.setItem(getStorageKey('lastCheckIn'), today);
                let stats = JSON.parse(localStorage.getItem(getStorageKey('englishStats')) || '{}');
                stats.dayCount = (stats.dayCount || 0) + 1;
                
                const lastStreak = localStorage.getItem(getStorageKey('lastStreakDate'));
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (lastStreak === yesterday.toDateString()) {
                    stats.streak = (stats.streak || 0) + 1;
                } else {
                    stats.streak = 1;
                }
                
                localStorage.setItem(getStorageKey('lastStreakDate'), today);
                localStorage.setItem(getStorageKey('englishStats'), JSON.stringify(stats));
                updateStats();
            }
        }

        function switchGrammarTab(index) {
            const grammarTabs = document.querySelectorAll('#grammarTabs .tab');
            const grammarContents = document.querySelectorAll('#grammarContent .tab-content');
            
            grammarTabs.forEach(tab => tab.classList.remove('active'));
            grammarContents.forEach(content => content.classList.remove('active'));
            
            grammarTabs[index].classList.add('active');
            grammarContents[index].classList.add('active');
        }

        function switchWritingTab(index) {
            const writingTabs = document.querySelectorAll('#writingTabs .tab');
            const writingContents = document.querySelectorAll('#writingContent .tab-content');
            
            writingTabs.forEach(tab => tab.classList.remove('active'));
            writingContents.forEach(content => content.classList.remove('active'));
            
            writingTabs[index].classList.add('active');
            writingContents[index].classList.add('active');
        }

        function checkLevel1() {
            const answer = document.getElementById('answer1').value.trim();
            const feedback = document.getElementById('feedback1');
            
            if (!answer) {
                feedback.innerHTML = '<div class="feedback error">âŒ è«‹è¼¸å…¥ç­”æ¡ˆ</div>';
                return;
            }

            const hasConnector = ['after', 'before', 'when', 'because', 'although', 'while', 'since', 'so', 'though'].some(word => answer.toLowerCase().includes(word));
            
            if (hasConnector && answer.length > 30) {
                feedback.innerHTML = `<div class="feedback success">âœ… å¾ˆå¥½ï¼ä½ æˆåŠŸçµ„åˆäº†å¥å­ã€‚é€™æ˜¯B2ç´šåˆ¥çš„å¥å­çµæ§‹ã€‚</div>`;
                incrementStats('wordCount');
                incrementStats('writingCount');
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ è©¦è‘—ä½¿ç”¨é€£æ¥è©(because, after, when, althoughç­‰)ä¾†çµ„åˆå¥å­ã€‚</div>`;
            }
        }

        function checkLevel2() {
            const answer = document.getElementById('answer2').value.trim();
            const feedback = document.getElementById('feedback2');
            const sentences = answer.split('.').filter(s => s.trim());
            
            if (!answer) {
                feedback.innerHTML = '<div class="feedback error">âŒ è«‹è¼¸å…¥ç­”æ¡ˆ</div>';
                return;
            }

            if (sentences.length >= 3 && sentences.length <= 6 && answer.length > 60) {
                feedback.innerHTML = `<div class="feedback success">âœ… å„ªç§€ï¼ä½ å¯«å‡ºäº†ä¸€å€‹çµæ§‹è‰¯å¥½çš„æ®µè½ã€‚åŒ…å«ä¸»é¡Œå¥å’Œæ”¯æŒå¥ã€‚</div>`;
                incrementStats('writingCount');
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ ä¸€å€‹å¥½æ®µè½æ‡‰è©²æœ‰3-5å€‹å¥å­ï¼Œä¸¦ä¸”åœç¹ä¸€å€‹ä¸»é¡Œå±•é–‹ã€‚</div>`;
            }
        }

        function checkLevel3() {
            const answer = document.getElementById('answer3').value.trim();
            const feedback = document.getElementById('feedback3');
            const words = answer.split(/\s+/).filter(w => w.length > 0).length;
            
            if (!answer) {
                feedback.innerHTML = '<div class="feedback error">âŒ è«‹è¼¸å…¥ç­”æ¡ˆ</div>';
                return;
            }

            if (words >= 150 && words <= 200) {
                feedback.innerHTML = `<div class="feedback success">âœ… å®Œç¾ï¼ä½ å¯«å‡ºäº†ä¸€ç¯‡${words}å­—çš„çŸ­æ–‡ï¼Œç¬¦åˆB2ç´šåˆ¥è¦æ±‚ã€‚</div>`;
                incrementStats('writingCount');
            } else if (words > 100) {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ ä½ çš„çŸ­æ–‡æœ‰${words}å­—ã€‚B2ç´šåˆ¥ç›®æ¨™æ˜¯150-200å­—ã€‚è©¦è‘—åŠ å…¥æ›´å¤šç´°ç¯€å’Œä¾‹å­ã€‚</div>`;
            } else {
                feedback.innerHTML = `<div class="feedback info">ğŸ’¡ ä½ çš„çŸ­æ–‡åªæœ‰${words}å­—ã€‚è«‹è£œå……åˆ°150-200å­—ã€‚</div>`;
            }
        }

        function addWordCounter() {
            const textarea = document.getElementById('answer3');
            if (textarea) {
                textarea.addEventListener('input', () => {
                    const words = textarea.value.split(/\s+/).filter(w => w.length > 0).length;
                    document.getElementById('wordCounter').textContent = words;
                });
            }
        }

        // é¡¯ç¤ºç•¶å‰æ—¥æœŸ
        function updateDateDisplay() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateStr = today.toLocaleDateString('zh-TW', options);
            document.getElementById('dateDisplay').textContent = `ğŸ“… ${dateStr}`;
        }

        // é è¦½æ—¥æœŸæ¨¡æ…‹æ¡†
        function previewFutureDay() {
            document.getElementById('previewModal').classList.add('show');
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('previewDate').valueAsDate = tomorrow;
        }

        function closePreviewModal() {
            document.getElementById('previewModal').classList.remove('show');
        }

        function loadPreviewContent() {
            const selectedDate = new Date(document.getElementById('previewDate').value);
            const dayOfYear = Math.floor((selectedDate - new Date(selectedDate.getFullYear(), 0, 0)) / 86400000);
            
            const level1Bank = writingExercisesBank.level1;
            const level2Bank = writingExercisesBank.level2;
            const level3Bank = writingExercisesBank.level3;
            
            const level1Ex = level1Bank[dayOfYear % level1Bank.length];
            const level2Ex = level2Bank[dayOfYear % level2Bank.length];
            const level3Ex = level3Bank[dayOfYear % level3Bank.length];
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateStr = selectedDate.toLocaleDateString('zh-TW', options);
            
            const grammarQ0 = grammarData[0].questions[dayOfYear % grammarData[0].questions.length];
            const grammarQ1 = grammarData[1].questions[dayOfYear % grammarData[1].questions.length];
            
            const html = `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: var(--primary); margin-bottom: 10px;">ğŸ“… ${dateStr}</h4>
                    
                    <div style="background: #FFF5E6; padding: 12px; border-radius: 6px; margin-bottom: 15px;">
                        <h5 style="color: var(--primary); margin-bottom: 8px;">âœï¸ ç´šåˆ¥1ï¼šå¥å­çµ„åˆ</h5>
                        <p style="font-size: 13px; margin-bottom: 5px;"><strong>é¡Œç›®ï¼š</strong> ${level1Ex.question}</p>
                        <p style="font-size: 13px; color: var(--text-light);"><strong>æç¤ºï¼š</strong> ${level1Ex.hint}</p>
                    </div>

                    <div style="background: #FFFAEB; padding: 12px; border-radius: 6px; margin-bottom: 15px;">
                        <h5 style="color: var(--primary); margin-bottom: 8px;">âœï¸ ç´šåˆ¥2ï¼šæ®µè½å¯«ä½œ</h5>
                        <p style="font-size: 13px; margin-bottom: 5px;"><strong>ä¸»é¡Œï¼š</strong> ${level2Ex.topic}</p>
                        <p style="font-size: 13px; color: var(--text-light);"><strong>é—œéµè©ï¼š</strong> ${level2Ex.keywords}</p>
                    </div>

                    <div style="background: #FFF0E6; padding: 12px; border-radius: 6px; margin-bottom: 15px;">
                        <h5 style="color: var(--primary); margin-bottom: 8px;">âœï¸ ç´šåˆ¥3ï¼šçŸ­æ–‡å‰µä½œ</h5>
                        <p style="font-size: 13px;"><strong>ä¸»é¡Œï¼š</strong> ${level3Ex.topic}</p>
                    </div>

                    <div style="background: #F0F5FF; padding: 12px; border-radius: 6px; margin-bottom: 15px;">
                        <h5 style="color: var(--primary); margin-bottom: 8px;">ğŸ“– æ–‡æ³•ç·´ç¿’ç¯„ä¾‹</h5>
                        <p style="font-size: 13px; margin-bottom: 8px;"><strong>${grammarData[0].topic}ï¼š</strong></p>
                        <p style="font-size: 12px; color: var(--text-light); margin-bottom: 8px;">${grammarQ0.question}</p>
                        <p style="font-size: 13px; margin-bottom: 8px;"><strong>${grammarData[1].topic}ï¼š</strong></p>
                        <p style="font-size: 12px; color: var(--text-light);">${grammarQ1.question}</p>
                    </div>

                    <p style="font-size: 12px; color: #999; text-align: center; padding-top: 10px; border-top: 1px solid var(--border);">
                        âœ… è¶…é60å¤©ç„¡é‡è¤‡ï¼è©å½™ã€å¯«ä½œã€æ–‡æ³•æ¯æ—¥æ›´æ–°
                    </p>
                </div>
            `;
            
            document.getElementById('previewContent').innerHTML = html;
        }

        // åˆå§‹åŒ–æ‡‰ç”¨
        function initApp() {
            initUserSystem();
            loadSchedule();
            loadVocabulary();
            updateDailyContent();
            loadGrammarQuizzes();
            updateStats();
            addWordCounter();
            performDailyCheckIn();
            performDailyReset();
            updateDateDisplay();
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', initApp);

        // å®šæ™‚æª¢æŸ¥æ¯æ—¥é‡ç½® (æ¯å°æ™‚æª¢æŸ¥ä¸€æ¬¡)
        setInterval(() => {
            performDailyReset();
            performDailyCheckIn();
        }, 3600000);
    </script>
</body>
</html>
